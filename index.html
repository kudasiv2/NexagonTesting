<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexagon - Premium Investment Protocol</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <style>
        :root {
            --bg-body: #050505;
            --bg-card: rgba(255, 255, 255, 0.03);
            --bg-card-hover: rgba(255, 255, 255, 0.07);
            --primary: #8B5CF6;
            --accent: #00D2FF;
            --white: #FFFFFF;
            --black: #000000;
            --text-muted: #9CA3AF;
            --border-light: rgba(255, 255, 255, 0.1);
            --glow: 0 0 20px rgba(139, 92, 246, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Outfit', sans-serif;
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--bg-body);
            color: var(--white);
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 15% 15%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 85% 85%, rgba(0, 210, 255, 0.1) 0%, transparent 50%);
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }

        /* --- UI Components: Toast --- */
        .toast-container {
            position: fixed;
            top: 24px;
            right: 24px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .toast {
            background: rgba(20, 20, 20, 0.95);
            border: 1px solid var(--border-light);
            border-left: 4px solid var(--primary);
            padding: 16px 20px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
            transform: translateX(120%);
            transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            color: white;
        }
        .toast.show { transform: translateX(0); }

        /* --- BUTTONS (White Theme) --- */
        .btn-white {
            background-color: var(--white);
            color: var(--black);
            border: none;
            padding: 14px 28px;
            border-radius: 50px; /* Pill shape */
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-decoration: none;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.15);
            min-width: 160px; /* Ukuran tidak terlalu besar */
        }

        .btn-white:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.3);
            background-color: #f0f0f0;
        }

        .btn-white i {
            font-size: 16px;
        }

        .btn-sm {
            padding: 10px 20px;
            font-size: 14px;
            min-width: auto;
        }

        /* --- Header & Navigation --- */
        header {
            background: rgba(5, 5, 5, 0.7);
            backdrop-filter: blur(20px);
            position: fixed;
            width: 100%;
            z-index: 1000;
            border-bottom: 1px solid var(--border-light);
            height: 80px;
            display: flex;
            align-items: center;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo img {
            height: 45px; /* Sesuaikan ukuran logo */
            width: auto;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.5px;
            color: var(--white);
        }

        /* Hamburger Menu */
        .hamburger-btn {
            background: transparent;
            border: none;
            color: var(--white);
            font-size: 24px;
            cursor: pointer;
            padding: 10px;
            transition: 0.3s;
        }
        .hamburger-btn:hover { color: var(--primary); }

        /* Sidebar Navigation */
        .sidebar {
            position: fixed;
            top: 0;
            right: -300px;
            width: 280px;
            height: 100vh;
            background: #0f0f0f;
            border-left: 1px solid var(--border-light);
            z-index: 1100;
            padding: 80px 30px;
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .sidebar.active { right: 0; }
        
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            z-index: 1050;
            display: none;
        }
        .sidebar-overlay.active { display: block; }

        .sidebar a {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 18px;
            font-weight: 500;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            transition: 0.3s;
        }
        .sidebar a:hover {
            color: var(--white);
            padding-left: 10px;
            border-bottom-color: var(--primary);
        }
        .close-sidebar {
            position: absolute;
            top: 25px;
            right: 25px;
            font-size: 24px;
            color: var(--white);
            background: none;
            border: none;
            cursor: pointer;
        }

        /* --- Hero Section --- */
        .hero {
            padding: 180px 0 100px;
            text-align: center;
        }
        .hero h1 {
            font-size: 56px;
            font-weight: 700;
            margin-bottom: 24px;
            background: linear-gradient(to right, #fff, #a5a5a5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .hero p {
            color: var(--text-muted);
            max-width: 600px;
            margin: 0 auto 40px;
            font-size: 18px;
        }

        /* Platform Stats Grid */
        .stats-grid-top {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 60px;
        }
        .stat-card-glass {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-light);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
        }
        .stat-card-glass h3 {
            font-size: 24px;
            color: var(--white);
            margin-bottom: 5px;
        }
        .stat-card-glass p {
            font-size: 13px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* --- Dashboard & Generic Grid --- */
        section { padding: 80px 0; }
        
        .section-header {
            text-align: center;
            margin-bottom: 50px;
        }
        .section-header h2 { font-size: 36px; margin-bottom: 10px; }
        .section-header p { color: var(--text-muted); }

        /* Premium Individual Box Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .premium-box {
            background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%);
            border: 1px solid var(--border-light);
            border-radius: 24px;
            padding: 30px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .premium-box:hover {
            border-color: rgba(139, 92, 246, 0.4);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .premium-box::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            opacity: 0.7;
        }

        .box-icon {
            font-size: 24px;
            color: var(--primary);
            margin-bottom: 15px;
            background: rgba(139, 92, 246, 0.1);
            width: 50px; height: 50px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%;
        }

        .box-label {
            color: var(--text-muted);
            font-size: 14px;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .box-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--white);
        }

        /* --- Plans --- */
        .plans-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
        }

        .plan-card {
            background: #0F0F0F;
            border: 1px solid var(--border-light);
            border-radius: 30px;
            padding: 40px 30px;
            width: 100%;
            max-width: 350px;
            position: relative;
            transition: 0.3s;
        }
        .plan-card:hover {
            border-color: var(--white);
        }
        
        .plan-header { margin-bottom: 20px; text-align: center; }
        .plan-percent { font-size: 42px; font-weight: 700; color: var(--primary); }
        .plan-percent span { font-size: 16px; color: var(--text-muted); font-weight: 400; }
        
        .plan-list { list-style: none; margin: 30px 0; }
        .plan-list li {
            display: flex; justify-content: space-between;
            padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
            font-size: 15px;
        }

        /* --- Referral & Leadership --- */
        .referral-actions-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            max-width: 600px;
            margin: 0 auto 50px;
            padding: 30px;
            background: rgba(255,255,255,0.02);
            border-radius: 24px;
            border: 1px solid var(--border-light);
        }

        .referral-link-box {
            width: 100%;
            display: flex;
            gap: 10px;
        }

        .ref-input {
            flex: 1;
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-light);
            padding: 12px 20px;
            border-radius: 50px;
            color: var(--text-muted);
            outline: none;
            text-align: center;
        }

        .levels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 15px;
            margin-top: 40px;
        }

        .level-card {
            background: rgba(20,20,20,0.8);
            border: 1px solid var(--border-light);
            padding: 15px;
            border-radius: 16px;
            text-align: center;
            position: relative;
        }
        .level-card.locked { opacity: 0.4; }
        .level-card.unlocked { border-color: var(--primary); background: rgba(139, 92, 246, 0.05); }

        /* --- Footer --- */
        footer {
            border-top: 1px solid var(--border-light);
            padding: 60px 0 30px;
            text-align: center;
            margin-top: 80px;
            background: #020202;
        }

        /* --- Modal --- */
        .modal {
            display: none;
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(8px);
            z-index: 2000;
            align-items: center; justify-content: center;
        }
        .modal-content {
            background: #111;
            border: 1px solid var(--border-light);
            border-radius: 24px;
            padding: 40px;
            width: 90%; max-width: 450px;
            position: relative;
        }
        .form-input {
            width: 100%; padding: 15px;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            color: white; margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .hero h1 { font-size: 36px; }
            .dashboard-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <!-- Notification Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Header -->
    <header>
        <div class="container header-container">
            <!-- Logo Section -->
            <div class="logo">
                <img src="image/logo.png" alt="Nexagon Logo">
                <div class="logo-text">NEXAGON</div>
            </div>
            
            <!-- Hamburger Menu (Top Right) -->
            <button class="hamburger-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- Sidebar Navigation -->
    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>
    <div class="sidebar" id="sidebar">
        <button class="close-sidebar" onclick="toggleSidebar()">&times;</button>
        <div class="logo" style="margin-bottom: 40px; padding-left: 0;">
            <span class="logo-text">MENU</span>
        </div>
        <a href="#home" onclick="toggleSidebar()"><i class="fas fa-home" style="width: 30px;"></i> Home</a>
        <a href="#dashboard" onclick="toggleSidebar()"><i class="fas fa-chart-line" style="width: 30px;"></i> Dashboard</a>
        <a href="#invest" onclick="toggleSidebar()"><i class="fas fa-coins" style="width: 30px;"></i> Invest</a>
        <a href="#referral" onclick="toggleSidebar()"><i class="fas fa-users" style="width: 30px;"></i> Referral</a>
        <a href="#leadership" onclick="toggleSidebar()"><i class="fas fa-crown" style="width: 30px;"></i> Leadership</a>
        
        <!-- Mobile Connect Button inside Sidebar -->
        <div style="margin-top: auto;">
            <button class="btn-white btn-sm" id="sidebarConnectBtn" style="width: 100%;">
                <i class="fas fa-wallet"></i> Connect Wallet
            </button>
            <div id="walletAddressDisplay" style="color: var(--primary); text-align: center; margin-top: 10px; display: none;"></div>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="container">
            <h1>Future of <br>Decentralized Wealth</h1>
            <p>Advanced smart contract protocol built for sustainability and transparency.</p>
            
            <!-- Hero Buttons -->
            <div style="display: flex; justify-content: center; gap: 20px;">
                <button class="btn-white" id="mainConnectBtn">
                    <i class="fas fa-wallet"></i> Connect Wallet
                </button>
                <a href="#dashboard" class="btn-white" style="background: transparent; border: 1px solid var(--white); color: var(--white);">
                    <i class="fas fa-chart-pie"></i> Dashboard
                </a>
            </div>

            <!-- Global Stats -->
            <div class="stats-grid-top">
                <div class="stat-card-glass">
                    <h3 id="tvl">0 USDT</h3>
                    <p>Total Value Locked</p>
                </div>
                <div class="stat-card-glass">
                    <h3 id="totalUsers">0</h3>
                    <p>Total Investors</p>
                </div>
                <div class="stat-card-glass">
                    <h3 id="totalInvested">0 USDT</h3>
                    <p>Total Invested</p>
                </div>
                <div class="stat-card-glass">
                    <h3 id="totalWithdrawn">0 USDT</h3>
                    <p>Total Withdrawn</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Dashboard Section (Individual Boxes) -->
    <section id="dashboard">
        <div class="container">
            <div class="section-header">
                <h2>My Dashboard</h2>
                <p>Personal portfolio analytics</p>
            </div>
            
            <div class="dashboard-grid">
                <!-- My Investment -->
                <div class="premium-box">
                    <div class="box-icon"><i class="fas fa-sack-dollar"></i></div>
                    <span class="box-label">My Investment</span>
                    <span class="box-value" id="userInvested">0 USDT</span>
                </div>
                
                <!-- Pending Rewards -->
                <div class="premium-box">
                    <div class="box-icon"><i class="fas fa-clock"></i></div>
                    <span class="box-label">Pending Rewards</span>
                    <span class="box-value" id="userPending">0 USDT</span>
                </div>
                
                <!-- Total Payout -->
                <div class="premium-box">
                    <div class="box-icon"><i class="fas fa-hand-holding-dollar"></i></div>
                    <span class="box-label">Total Payout</span>
                    <span class="box-value" id="userWithdrawn">0 USDT</span>
                </div>

                <!-- ROI Action -->
                <div class="premium-box" style="background: transparent; border: none; box-shadow: none;">
                    <button class="btn-white" id="withdrawROI" style="width: 100%; height: 100%;">
                        <i class="fas fa-download"></i> Withdraw ROI
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Investment Section -->
    <section id="invest">
        <div class="container">
            <div class="section-header">
                <h2>Investment Plans</h2>
                <p>Choose your preferred strategy</p>
            </div>
            
            <div class="plans-container">
                <!-- Plan 1 -->
                <div class="plan-card">
                    <div class="plan-header">
                        <h3>Gold Plan</h3>
                        <div class="plan-percent">16% <span>/ Day</span></div>
                    </div>
                    <ul class="plan-list">
                        <li><span>Duration</span> <span>7 Days</span></li>
                        <li><span>Total Return</span> <span>112%</span></li>
                        <li><span>Min Deposit</span> <span>10 USDT</span></li>
                        <li><span>Withdraw</span> <span>Every 8 Hours</span></li>
                    </ul>
                    <button class="btn-white" style="width: 100%;" onclick="openInvestModal(0, 100)">
                        <i class="fas fa-rocket"></i> Invest Now
                    </button>
                </div>

                <!-- Plan 2 -->
                <div class="plan-card" style="border-color: var(--primary);">
                    <div class="plan-header">
                        <h3>Platinum Plan</h3>
                        <div class="plan-percent">9% <span>/ Day</span></div>
                    </div>
                    <ul class="plan-list">
                        <li><span>Duration</span> <span>14 Days</span></li>
                        <li><span>Total Return</span> <span>126%</span></li>
                        <li><span>Min Deposit</span> <span>50 USDT</span></li>
                        <li><span>Withdraw</span> <span>Every 8 Hours</span></li>
                    </ul>
                    <button class="btn-white" style="width: 100%;" onclick="openInvestModal(1, 100)">
                        <i class="fas fa-rocket"></i> Invest Now
                    </button>
                </div>

                <!-- Plan 3 -->
                <div class="plan-card">
                    <div class="plan-header">
                        <h3>Diamond Plan</h3>
                        <div class="plan-percent">5% <span>/ Day</span></div>
                    </div>
                    <ul class="plan-list">
                        <li><span>Duration</span> <span>30 Days</span></li>
                        <li><span>Total Return</span> <span>150%</span></li>
                        <li><span>Min Deposit</span> <span>100 USDT</span></li>
                        <li><span>Withdraw</span> <span>Every 8 Hours</span></li>
                    </ul>
                    <button class="btn-white" style="width: 100%;" onclick="openInvestModal(2, 9999999)">
                        <i class="fas fa-rocket"></i> Invest Now
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Referral Section -->
    <section id="referral">
        <div class="container">
            <div class="section-header">
                <h2>Referral Program</h2>
                <p>Earn commissions from 15 levels</p>
            </div>

            <div class="dashboard-grid">
                <div class="premium-box">
                    <div class="box-icon"><i class="fas fa-gift"></i></div>
                    <span class="box-label">Referral Earnings</span>
                    <span class="box-value" id="referralBonus">0 USDT</span>
                </div>
                <div class="premium-box">
                    <div class="box-icon"><i class="fas fa-layer-group"></i></div>
                    <span class="box-label">Current Level</span>
                    <span class="box-value" id="referralLevel">0</span>
                </div>
            </div>

            <!-- Referral Actions Area -->
            <div class="referral-actions-container">
                <!-- 1. Tombol Withdraw (Atas) -->
                <button class="btn-white" id="withdrawReferral">
                    <i class="fas fa-download"></i> Withdraw Referral
                </button>

                <!-- 2. Link Referral + Copy (Bawah) -->
                <div class="referral-link-box">
                    <input type="text" id="myReferralLink" class="ref-input" value="Connect Wallet to get Link" readonly>
                    <button class="btn-white btn-sm" onclick="copyReferralLink()">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
            </div>

            <!-- Levels Grid -->
            <div class="levels-grid" id="referralLevelsContainer">
                <!-- JS Generated -->
            </div>
        </div>
    </section>

    <!-- Leadership Section -->
    <section id="leadership">
        <div class="container">
            <div class="section-header">
                <h2>Leadership Program</h2>
                <p>Build your team to unlock extra rewards</p>
            </div>

            <div class="dashboard-grid">
                <div class="premium-box">
                    <div class="box-icon"><i class="fas fa-trophy"></i></div>
                    <span class="box-label">Leadership Earnings</span>
                    <span class="box-value" id="leadershipBonus">0 USDT</span>
                </div>
                <div class="premium-box">
                    <div class="box-icon"><i class="fas fa-users"></i></div>
                    <span class="box-label">Team Size</span>
                    <span class="box-value" id="teamSize">0</span>
                </div>
            </div>

            <div style="text-align: center; margin-bottom: 40px;">
                <button class="btn-white" id="withdrawLeadership">
                    <i class="fas fa-download"></i> Withdraw Leadership
                </button>
            </div>

            <div class="dashboard-grid" id="leadershipLevelsContainer">
                <!-- JS Generated -->
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="logo" style="justify-content: center; margin-bottom: 20px;">
                <img src="image/logo.png" alt="Logo" style="height: 40px;">
                <div class="logo-text">NEXAGON</div>
            </div>
            <p style="color: var(--text-muted); font-size: 14px;">&copy; 2024 Nexagon Protocol. All rights reserved.</p>
        </div>
    </footer>

    <!-- Invest Modal -->
    <div class="modal" id="investModal">
        <div class="modal-content">
            <button class="close-sidebar" onclick="closeInvestModal()" style="position:absolute; right:20px; top:20px; color:white;">&times;</button>
            <h2 style="margin-bottom: 20px;">Invest</h2>
            <input type="hidden" id="selectedPlanId">
            <input type="number" class="form-input" id="investAmount" placeholder="Amount (USDT)">
            <input type="text" class="form-input" id="referrerInput" placeholder="Upline Address (Optional)" readonly>
            <button class="btn-white" style="width: 100%;" id="confirmInvestBtn">
                Confirm Investment
            </button>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // --- Sidebar Logic ---
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
            document.querySelector('.sidebar-overlay').classList.toggle('active');
        }

        // --- Notification Logic ---
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `<i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-triangle'}" style="color: ${type === 'success' ? '#10B981' : '#EF4444'}"></i> <span>${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }

        // --- Mock Data & Logic for Display ---
        // (Sama seperti logika sebelumnya, disesuaikan dengan UI baru)
        
        let userAccount = null;
        const DOMAIN_URL = window.location.origin + window.location.pathname;

        // Init Events
        document.getElementById('mainConnectBtn').addEventListener('click', connectWallet);
        document.getElementById('sidebarConnectBtn').addEventListener('click', connectWallet);

        async function connectWallet() {
            if (window.ethereum) {
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    userAccount = accounts[0];
                    handleLoginSuccess();
                } catch (error) {
                    showToast("Connection failed", "error");
                }
            } else {
                showToast("Metamask not found!", "error");
            }
        }

        function handleLoginSuccess() {
            showToast("Wallet Connected!");
            
            // Update UI Buttons
            const shortAddr = userAccount.substring(0,6) + '...' + userAccount.substring(userAccount.length - 4);
            
            document.getElementById('mainConnectBtn').innerHTML = `<i class="fas fa-user-check"></i> Start Investing`;
            document.getElementById('mainConnectBtn').onclick = () => { document.getElementById('invest').scrollIntoView(); };

            document.getElementById('sidebarConnectBtn').style.display = 'none';
            const walletDisplay = document.getElementById('walletAddressDisplay');
            walletDisplay.style.display = 'block';
            walletDisplay.textContent = shortAddr;

            // Update Referral Link Input
            const refLink = `${DOMAIN_URL}?ref=${userAccount}`;
            document.getElementById('myReferralLink').value = refLink;

            // Load Dummy Data (Simulasi Smart Contract)
            loadData();
        }

        function loadData() {
            // Simulasi data masuk ke Box Dashboard
            document.getElementById('userInvested').textContent = "100.00 USDT";
            document.getElementById('userPending').textContent = "16.00 USDT";
            document.getElementById('userWithdrawn').textContent = "50.00 USDT";
            
            // Stats Global
            document.getElementById('tvl').textContent = "542,000 USDT";
            document.getElementById('totalUsers').textContent = "1,240";

            renderLevels(100); // Simulasi user invest 100
        }

        // Copy Function
        function copyReferralLink() {
            const copyText = document.getElementById("myReferralLink");
            if(copyText.value === "Connect Wallet to get Link") {
                showToast("Connect Wallet first!", "error");
                return;
            }
            
            copyText.select();
            copyText.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(copyText.value);
            showToast("Referral link copied!");
        }

        // Modal Logic
        function openInvestModal(planId, max) {
            if(!userAccount) {
                showToast("Please Connect Wallet first!", "error");
                return;
            }
            document.getElementById('investModal').style.display = 'flex';
            document.getElementById('selectedPlanId').value = planId;
            
            // Check URL for referrer
            const urlParams = new URLSearchParams(window.location.search);
            const ref = urlParams.get('ref');
            if(ref) document.getElementById('referrerInput').value = ref;
        }

        function closeInvestModal() {
            document.getElementById('investModal').style.display = 'none';
        }

        document.getElementById('confirmInvestBtn').addEventListener('click', () => {
            const amt = document.getElementById('investAmount').value;
            if(amt > 0) {
                showToast("Investment processing...");
                setTimeout(() => {
                    showToast("Investment Successful!");
                    closeInvestModal();
                    loadData();
                }, 1500);
            } else {
                showToast("Invalid Amount", "error");
            }
        });

        // Withdraw Buttons
        document.getElementById('withdrawROI').addEventListener('click', () => mockWithdraw('ROI'));
        document.getElementById('withdrawReferral').addEventListener('click', () => mockWithdraw('Referral'));
        document.getElementById('withdrawLeadership').addEventListener('click', () => mockWithdraw('Leadership'));

        function mockWithdraw(type) {
            if(!userAccount) return showToast("Connect Wallet first!", "error");
            showToast(`Requesting ${type} Withdrawal...`);
            setTimeout(() => showToast(`${type} Withdrawal Successful!`), 1000);
        }

        // Render Levels
        function renderLevels(investAmt) {
            const container = document.getElementById('referralLevelsContainer');
            container.innerHTML = '';
            const percents = [15,10,5,5,3,3,3,2,2,2,1,1,1,1,1];
            
            percents.forEach((pct, idx) => {
                const lvl = idx + 1;
                // Simulasi logika unlock: setiap level butuh +50 USDT investasi
                const req = lvl * 50; 
                const isUnlocked = investAmt >= req;
                
                const div = document.createElement('div');
                div.className = `level-card ${isUnlocked ? 'unlocked' : 'locked'}`;
                div.innerHTML = `
                    <div style="font-size:12px; color:#aaa;">Level ${lvl}</div>
                    <div style="font-size:24px; font-weight:bold; color:${isUnlocked ? '#8B5CF6' : '#555'}">${pct}%</div>
                    ${!isUnlocked ? '<i class="fas fa-lock" style="margin-top:5px;"></i>' : ''}
                `;
                container.appendChild(div);
            });
        }
    </script>
</body>
</html>
