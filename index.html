<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Nexagon - Platform Investasi DeFi Generasi Selanjutnya dengan ROI Stabil dan Sistem Referral 15 Level.">
    <meta property="og:title" content="Nexagon - Next Generation Investment Protocol">
    <meta property="og:description" content="Platform Investasi DeFi Premium dengan Smart Contract Terverifikasi.">
    <title>Nexagon | Premium DeFi Protocol</title>
    <link rel="icon" type="image/x-icon" href="image/favicon.ico">
    
    <!-- Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bignumber.js@9.1.2/bignumber.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    
    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <style>
        :root {
            /* Premium Dark Theme Palette */
            --bg-deep: #030014;
            --bg-card: rgba(17, 12, 34, 0.6);
            --bg-glass: rgba(255, 255, 255, 0.03);
            
            --primary: #7000FF;
            --primary-glow: #9F33FF;
            --secondary: #00D2FF; /* Cyan accent for modern look */
            --accent: #FF00E5;
            
            --text-main: #FFFFFF;
            --text-muted: #94A3B8;
            
            --gradient-main: linear-gradient(135deg, #7000FF 0%, #AF40FF 100%);
            --gradient-glow: radial-gradient(circle at center, rgba(112, 0, 255, 0.4) 0%, transparent 70%);
            --gradient-card-border: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            
            --font-heading: 'Outfit', sans-serif;
            --font-body: 'Inter', sans-serif;
            
            --border-glass: 1px solid rgba(255, 255, 255, 0.08);
            --shadow-glow: 0 0 20px rgba(112, 0, 255, 0.3);
        }

        /* Reset & Base */
        * { margin: 0; padding: 0; box-sizing: border-box; scroll-behavior: smooth; }
        body {
            font-family: var(--font-body);
            background-color: var(--bg-deep);
            color: var(--text-main);
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Animated Background */
        .bg-orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.4;
            animation: orbFloat 10s infinite alternate;
        }
        .orb-1 { width: 300px; height: 300px; top: -50px; left: -50px; background: var(--primary); }
        .orb-2 { width: 400px; height: 400px; bottom: 0; right: 0; background: var(--secondary); animation-delay: -5s; }
        .orb-3 { width: 200px; height: 200px; top: 40%; left: 40%; background: var(--accent); opacity: 0.2; }

        @keyframes orbFloat {
            0% { transform: translate(0, 0); }
            100% { transform: translate(30px, 50px); }
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 { font-family: var(--font-heading); font-weight: 700; color: #fff; }
        .gradient-text {
            background: linear-gradient(to right, #fff, #bca5ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .gradient-text-primary {
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Layout */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 24px; }
        .section { padding: 100px 0; position: relative; }
        
        /* Preloader */
        .preloader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-deep); z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            flex-direction: column; transition: opacity 0.5s ease;
        }
        .preloader.fade-out { opacity: 0; pointer-events: none; }
        .spinner {
            width: 50px; height: 50px; border: 3px solid rgba(112, 0, 255, 0.3);
            border-radius: 50%; border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Navbar */
        .header {
            position: fixed; top: 0; left: 0; width: 100%; z-index: 1000;
            background: rgba(3, 0, 20, 0.7); backdrop-filter: blur(15px);
            border-bottom: var(--border-glass); transition: 0.3s;
        }
        .nav { height: 80px; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-family: var(--font-heading); font-size: 24px; font-weight: 800; display: flex; align-items: center; gap: 10px; color: #fff; text-decoration: none; }
        .logo img { width: 40px; }
        
        .nav__menu { display: flex; gap: 30px; align-items: center; }
        .nav__link {
            color: var(--text-muted); text-decoration: none; font-weight: 500; font-size: 15px;
            transition: 0.3s; position: relative;
        }
        .nav__link:hover, .nav__link.active { color: #fff; text-shadow: 0 0 10px rgba(255,255,255,0.5); }
        .nav__link::after {
            content: ''; position: absolute; bottom: -5px; left: 0; width: 0; height: 2px;
            background: var(--primary); transition: 0.3s;
        }
        .nav__link.active::after { width: 100%; }

        /* Buttons */
        .btn {
            padding: 12px 28px; border-radius: 50px; font-weight: 600; font-family: var(--font-heading);
            text-decoration: none; border: none; cursor: pointer; transition: 0.3s;
            display: inline-flex; align-items: center; gap: 8px; font-size: 15px;
            position: relative; overflow: hidden; z-index: 1;
        }
        .btn--primary {
            background: var(--gradient-main); color: #fff;
            box-shadow: 0 4px 15px rgba(112, 0, 255, 0.4);
        }
        .btn--primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(112, 0, 255, 0.6); }
        
        .btn--outline {
            background: transparent; color: #fff; border: 1px solid var(--primary);
        }
        .btn--outline:hover { background: rgba(112, 0, 255, 0.1); border-color: var(--secondary); color: var(--secondary); }

        /* Cards (Glassmorphism) */
        .glass-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border: var(--border-glass);
            border-radius: 24px; padding: 30px;
            position: relative; overflow: hidden;
            transition: 0.3s;
        }
        .glass-card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        }
        .glass-card:hover { transform: translateY(-5px); border-color: rgba(112, 0, 255, 0.3); }

        /* Hero Section */
        .hero { min-height: 100vh; padding-top: 150px; display: flex; align-items: center; position: relative; }
        .hero-content h1 { font-size: 3.5rem; line-height: 1.1; margin-bottom: 20px; }
        .hero-content p { font-size: 1.2rem; color: var(--text-muted); margin-bottom: 40px; max-width: 600px; }
        .hero-stats {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;
            margin-top: 50px;
        }

        /* Stats & Dashboard */
        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 24px; }
        .stat-value { font-size: 1.8rem; font-weight: 700; color: #fff; margin-bottom: 5px; }
        .stat-label { font-size: 0.9rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
        .stat-icon {
            width: 50px; height: 50px; border-radius: 12px; background: rgba(255,255,255,0.05);
            display: flex; align-items: center; justify-content: center; font-size: 20px; color: var(--primary);
            margin-bottom: 15px;
        }

        /* Investment Plans */
        .plan-card {
            text-align: center; border: 1px solid rgba(255,255,255,0.05);
            transition: 0.4s; position: relative;
        }
        .plan-card:hover { border-color: var(--primary); box-shadow: var(--shadow-glow); }
        .plan-card.featured {
            background: linear-gradient(160deg, rgba(112, 0, 255, 0.1), rgba(3, 0, 20, 0.8));
            border: 1px solid var(--primary);
        }
        .plan-roi { font-size: 2.5rem; font-weight: 800; color: var(--secondary); margin: 15px 0; }
        .plan-features li {
            list-style: none; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
            color: var(--text-muted); font-size: 0.95rem;
        }
        .plan-features i { color: var(--primary); margin-right: 8px; }

        /* Form */
        .form-input {
            width: 100%; padding: 15px; background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1); border-radius: 12px;
            color: #fff; font-family: var(--font-body); outline: none; transition: 0.3s;
        }
        .form-input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(112, 0, 255, 0.2); }

        /* Notification */
        .notification {
            position: fixed; bottom: 30px; right: 30px; padding: 15px 25px;
            background: rgba(10, 10, 10, 0.9); border-left: 4px solid var(--primary);
            color: #fff; border-radius: 8px; backdrop-filter: blur(10px);
            transform: translateX(200%); transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 9999; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .notification.show { transform: translateX(0); }
        .notification.success { border-color: #00ff88; }
        .notification.error { border-color: #ff0055; }

        /* Timer */
        .timer-box {
            display: flex; gap: 10px; justify-content: center; margin-top: 15px;
            background: rgba(255,255,255,0.05); padding: 10px; border-radius: 12px;
        }
        .timer-segment { text-align: center; }
        .timer-num {
            font-family: monospace; font-size: 1.2rem; font-weight: 700; color: var(--secondary);
            background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 6px;
        }
        .timer-lbl { font-size: 0.7rem; color: var(--text-muted); margin-top: 4px; }

        /* Mobile Nav */
        .nav__toggle { display: none; font-size: 24px; cursor: pointer; color: #fff; }
        
        @media (max-width: 768px) {
            .hero-content h1 { font-size: 2.5rem; }
            .nav__menu {
                position: fixed; top: 80px; left: -100%; width: 100%; height: calc(100vh - 80px);
                background: #030014; flex-direction: column; padding: 40px;
                transition: 0.4s; align-items: flex-start;
            }
            .nav__menu.active { left: 0; }
            .nav__toggle { display: block; }
            .hero { padding-top: 120px; flex-direction: column; text-align: center; }
            .hero-content p { margin: 0 auto 30px; }
            .hero-stats { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <!-- Background Animation -->
    <div class="bg-orb orb-1"></div>
    <div class="bg-orb orb-2"></div>
    <div class="bg-orb orb-3"></div>

    <!-- Preloader -->
    <div class="preloader">
        <div class="spinner"></div>
        <div style="margin-top: 15px; font-weight: 600; letter-spacing: 2px;">LOADING NEXAGON</div>
    </div>

    <!-- Header -->
    <header class="header">
        <nav class="nav container">
            <a href="#" class="logo">
                <i class="fas fa-hexagon-nodes" style="color: var(--primary);"></i>
                <span class="gradient-text">NEXAGON</span>
            </a>

            <div class="nav__menu" id="nav-menu">
                <a class="nav__link active" data-section="home">Home</a>
                <a class="nav__link" data-section="dashboard">Dashboard</a>
                <a class="nav__link" data-section="invest">Plans</a>
                <a class="nav__link" data-section="referral">Network</a>
                <a class="nav__link" data-section="leadership">Leadership</a>
                <a class="nav__link" data-section="faq">FAQ</a>
                
                <button class="btn btn--outline" id="connectWallet">
                    <i class="fas fa-wallet"></i> Connect Wallet
                </button>
            </div>

            <div class="nav__toggle" id="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>
        </nav>
    </header>

    <main>
        <!-- Home Section -->
        <section class="section hero" id="home">
            <div class="container" style="display: grid; grid-template-columns: lg(1fr 1fr); gap: 50px; align-items: center;">
                <div class="hero-content" data-aos="fade-right">
                    <div style="display: inline-block; padding: 5px 15px; background: rgba(112, 0, 255, 0.1); border-radius: 20px; border: 1px solid rgba(112, 0, 255, 0.3); margin-bottom: 20px; font-size: 0.9rem; color: var(--secondary);">
                        <i class="fas fa-bolt"></i> Next-Gen Yield Farming
                    </div>
                    <h1>Maximize Your Crypto <br> With <span class="gradient-text-primary">Intelligent ROI</span></h1>
                    <p>Hasilkan pendapatan pasif harian yang stabil melalui protokol DeFi terdesentralisasi kami. Aman, transparan, dan didukung oleh sistem referral 15-level.</p>
                    
                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        <button class="btn btn--primary" onclick="showSection('invest')">
                            Start Investing <i class="fas fa-arrow-right"></i>
                        </button>
                        <button class="btn btn--outline" onclick="showSection('dashboard')">
                            View Dashboard
                        </button>
                    </div>

                    <div class="glass-card" style="margin-top: 40px; padding: 20px; display: inline-block; min-width: 300px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
                            <span style="font-size: 0.9rem; color: var(--text-muted);">Contract Status</span>
                            <span style="color: #00ff88; font-size: 0.8rem; display: flex; align-items: center; gap: 5px;"><div style="width: 8px; height: 8px; background: #00ff88; border-radius: 50%; box-shadow: 0 0 10px #00ff88;"></div> LIVE</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <div style="font-size: 0.8rem; color: var(--text-muted);">Total Value Locked</div>
                                <div id="statTvl" style="font-size: 1.1rem; font-weight: 700;">Loading...</div>
                            </div>
                            <div>
                                <div style="font-size: 0.8rem; color: var(--text-muted);">Total Users</div>
                                <div id="statTotalUsers" style="font-size: 1.1rem; font-weight: 700;">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section class="section" id="dashboard" style="display: none;">
            <div class="container">
                <div style="text-align: center; margin-bottom: 50px;" data-aos="fade-up">
                    <h2 class="gradient-text">User Dashboard</h2>
                    <p style="color: var(--text-muted);">Monitor your assets and performance in real-time</p>
                </div>

                <!-- Wallet Alert -->
                <div id="dashboardWalletAlert" class="glass-card" style="text-align: center; padding: 40px; margin-bottom: 30px;">
                    <i class="fas fa-wallet" style="font-size: 40px; color: var(--text-muted); margin-bottom: 20px;"></i>
                    <h3>Connect Your Wallet</h3>
                    <p style="color: var(--text-muted); margin-bottom: 20px;">Please connect your wallet to view your dashboard statistics.</p>
                </div>

                <!-- Stats Grid -->
                <div id="quickStats" class="stat-grid" style="display: none;">
                    <div class="glass-card" data-aos="zoom-in" data-aos-delay="100">
                        <div class="stat-icon"><i class="fas fa-coins"></i></div>
                        <div class="stat-value" id="totalInvested">0.00 USDT</div>
                        <div class="stat-label">Total Active Deposit</div>
                    </div>
                    <div class="glass-card" data-aos="zoom-in" data-aos-delay="200">
                        <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
                        <div class="stat-value" id="pendingRewards">0.00 USDT</div>
                        <div class="stat-label">Pending ROI</div>
                    </div>
                    <div class="glass-card" data-aos="zoom-in" data-aos-delay="300">
                        <div class="stat-icon"><i class="fas fa-users"></i></div>
                        <div class="stat-value" id="totalEarnings">0.00 USDT</div>
                        <div class="stat-label">Total Earnings</div>
                    </div>
                </div>

                <!-- Actions -->
                <div id="actionButtons" style="display: none; justify-content: center; gap: 20px; flex-wrap: wrap; margin-top: 40px;">
                    <button class="btn btn--primary" id="withdrawROI" style="min-width: 200px;">
                        <i class="fas fa-download"></i> Withdraw ROI
                    </button>
                    <div id="withdrawTimer" class="timer-box" style="display: none;">
                        <div class="timer-segment">
                            <div class="timer-num" id="timerHours">00</div>
                            <div class="timer-lbl">Hrs</div>
                        </div>
                        <div style="font-weight: bold; padding-top: 5px;">:</div>
                        <div class="timer-segment">
                            <div class="timer-num" id="timerMinutes">00</div>
                            <div class="timer-lbl">Min</div>
                        </div>
                        <div style="font-weight: bold; padding-top: 5px;">:</div>
                        <div class="timer-segment">
                            <div class="timer-num" id="timerSeconds">00</div>
                            <div class="timer-lbl">Sec</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Invest Section -->
        <section class="section" id="invest" style="display: none;">
            <div class="container">
                <div style="text-align: center; margin-bottom: 50px;" data-aos="fade-up">
                    <h2 class="gradient-text">Investment Plans</h2>
                    <p style="color: var(--text-muted);">Choose the plan that suits your financial goals</p>
                </div>

                <div id="investWalletAlert" class="glass-card" style="text-align: center; margin-bottom: 30px;">
                    <p><i class="fas fa-lock"></i> Connect wallet to interact with plans</p>
                </div>

                <div class="stat-grid" id="investmentPlans">
                    <!-- Plans Injected JS -->
                </div>

                <!-- Investment Form Modal-ish -->
                <div id="investmentForm" class="glass-card" style="display: none; max-width: 500px; margin: 0 auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3>Invest in <span id="planNameDisplay" style="color: var(--primary);">Plan</span></h3>
                        <button class="btn btn--outline" id="backToPlans" style="padding: 5px 10px; font-size: 0.8rem;">Cancel</button>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; color: var(--text-muted);">Amount (USDT)</label>
                        <input type="number" id="investmentAmount" class="form-input" placeholder="Min: 10 USDT">
                        <small id="amountRange" style="color: var(--secondary); display: block; margin-top: 5px;"></small>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 10px; color: var(--text-muted);">Referrer (Optional)</label>
                        <input type="text" id="referrerAddress" class="form-input" placeholder="0x...">
                    </div>

                    <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: var(--text-muted);">Amount:</span>
                            <span id="summaryAmount">0.00 USDT</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span style="color: var(--text-muted);">Fee (10%):</span>
                            <span id="summaryFee">0.00 USDT</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 5px;">
                            <span>Total Pay:</span>
                            <span id="summaryTotal" style="color: var(--primary); font-weight: bold;">0.00 USDT</span>
                        </div>
                    </div>

                    <button class="btn btn--primary" id="confirmInvestment" style="width: 100%;">
                        Confirm & Pay
                    </button>
                </div>
            </div>
        </section>

        <!-- Referral Section -->
        <section class="section" id="referral" style="display: none;">
            <div class="container">
                <div style="text-align: center; margin-bottom: 50px;">
                    <h2 class="gradient-text">Affiliate Program</h2>
                    <p style="color: var(--text-muted);">Earn up to 15 levels deep. The most powerful network rewards.</p>
                </div>

                <div id="referralStats" class="stat-grid" style="display: none; margin-bottom: 40px;">
                    <div class="glass-card">
                        <div class="stat-label">Referral Earnings</div>
                        <div class="stat-value" id="referralBonusAmount">0.00 USDT</div>
                    </div>
                    <div class="glass-card">
                        <div class="stat-label">Total Team</div>
                        <div class="stat-value" id="referralTeamCount">0</div>
                    </div>
                    <div class="glass-card">
                        <div class="stat-label">Current Level</div>
                        <div class="stat-value" id="referralLevel" style="color: var(--secondary);">Lvl 0</div>
                    </div>
                </div>

                <div id="referralLinkSection" class="glass-card" style="display: none; max-width: 800px; margin: 0 auto 40px;">
                    <h3 style="margin-bottom: 15px;">Your Referral Link</h3>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <input type="text" id="referralLink" class="form-input" readonly style="flex: 1;">
                        <button class="btn btn--primary" id="copyLink"><i class="fas fa-copy"></i> Copy</button>
                    </div>
                    <div style="display: flex; justify-content: center; gap: 15px; margin-top: 20px;">
                        <button class="btn btn--outline" id="withdrawReferral">
                            <i class="fas fa-gift"></i> Withdraw Rewards
                        </button>
                    </div>
                </div>

                <div class="glass-card" style="overflow-x: auto;">
                     <h3 style="margin-bottom: 20px;">Commission Structure</h3>
                     <div id="referralLevelsCompact" style="display: flex; gap: 15px; padding-bottom: 10px;">
                         <!-- Levels Injected Here -->
                     </div>
                </div>
            </div>
        </section>

        <!-- Leadership Section -->
        <section class="section" id="leadership" style="display: none;">
            <div class="container">
                <div style="text-align: center; margin-bottom: 50px;">
                    <h2 class="gradient-text">Leadership Bonuses</h2>
                    <p style="color: var(--text-muted);">Exclusive rewards for top team builders.</p>
                </div>

                <div id="leadershipStats" class="stat-grid" style="display: none; margin-bottom: 30px;">
                    <div class="glass-card">
                        <div class="stat-label">Leadership Bonus</div>
                        <div class="stat-value" id="leadershipBonusStats">0.00 USDT</div>
                    </div>
                    <div class="glass-card">
                        <div class="stat-label">Rank</div>
                        <div class="stat-value" id="currentLeadershipLevel" style="color: var(--accent);">None</div>
                    </div>
                </div>

                <div id="leadershipActionButtons" style="text-align: center; display: none; margin-bottom: 40px;">
                    <button class="btn btn--primary" id="withdrawLeadership">
                        <i class="fas fa-crown"></i> Claim Leadership Bonus
                    </button>
                </div>

                <div id="leadershipLevelsCompact" class="stat-grid">
                    <!-- Injected JS -->
                </div>
            </div>
        </section>
        
         <!-- FAQ Section -->
         <section class="section" id="faq" style="display: none;">
            <div class="container">
                <div style="text-align: center; margin-bottom: 50px;">
                    <h2 class="gradient-text">FAQ</h2>
                    <p style="color: var(--text-muted);">Frequently Asked Questions</p>
                </div>
                <div class="glass-card" style="max-width: 800px; margin: 0 auto;">
                    <div class="faq-item" style="margin-bottom: 20px;">
                        <h4 style="color: var(--secondary);">How is ROI calculated?</h4>
                        <p style="color: var(--text-muted);">ROI is calculated daily based on the plan you choose, ranging from 5% to 16% daily.</p>
                    </div>
                    <div class="faq-item" style="margin-bottom: 20px;">
                        <h4 style="color: var(--secondary);">Is there a withdrawal limit?</h4>
                        <p style="color: var(--text-muted);">No maximum limit, but withdrawals are subject to an 8-hour cooldown period.</p>
                    </div>
                     <div class="faq-item">
                        <h4 style="color: var(--secondary);">How does the referral system work?</h4>
                        <p style="color: var(--text-muted);">You earn commissions from 15 levels of downlines. You need to have an active deposit to receive commissions.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Notification Container -->
    <div class="notification" id="notification">Message here</div>

    <script>
        // Init Animation
        AOS.init({ duration: 1000, once: true });

        // Configuration
        const CONTRACT_ADDRESS = '0xDA2F51341b76DCBc8dAA41DFfd20CDC8fCF12eee';
        const USDT_ADDRESS = '0x55d398326f99059fF775485246999027B3197955';
        const RPC_URL = 'https://bsc-dataseed1.binance.org/';
        
        // Minimal ABIs
        const USDT_ABI = [{"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_spender","type":"address"}],"name":"allowance","outputs":[{"name":"","type":"uint256"}],"type":"function"}];
        // Using the full ABI provided in your original request (contract interaction logic remains the same)
        const CONTRACT_ABI = [{"inputs":[{"internalType":"address","name":"_usdtAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"leader","type":"address"},{"indexed":false,"internalType":"uint256","name":"level","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"LeadershipBonusAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"planId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"address","name":"referrer","type":"address"}],"name":"NewDeposit","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"referrer","type":"address"},{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"level","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ReferralBonusAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ReferralExpiredWithdrawn","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"processedAmount","type":"uint256"}],"name":"SystemMetricsUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"WithdrawLeadership","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"WithdrawROI","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"WithdrawReferral","type":"event"},{"inputs":[],"name":"CLAIM_COOLDOWN","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"PERCENTS_DIVIDER","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ReferralExpired","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"TIME_STEP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"USDT","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"},{"internalType":"uint256","name":"_investmentIndex","type":"uint256"}],"name":"calculateRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getContractBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getLeadershipRates","outputs":[{"internalType":"uint256[3]","name":"","type":"uint256[3]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getLeadershipRequirements","outputs":[{"internalType":"uint256[3]","name":"","type":"uint256[3]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getNextWithdrawTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getPendingRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_planId","type":"uint256"}],"name":"getPlanInfo","outputs":[{"internalType":"uint256","name":"minDeposit","type":"uint256"},{"internalType":"uint256","name":"maxDeposit","type":"uint256"},{"internalType":"uint256","name":"dailyROI","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"totalReturn","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getPlatformStats","outputs":[{"internalType":"uint256","name":"contractBalance","type":"uint256"},{"internalType":"uint256","name":"totalInvestors_","type":"uint256"},{"internalType":"uint256","name":"totalInvested_","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn_","type":"uint256"},{"internalType":"uint256","name":"totalReferralBonus_","type":"uint256"},{"internalType":"uint256","name":"totalLeadershipBonus_","type":"uint256"},{"internalType":"uint256","name":"referralExpiredBalance_","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getReferralRates","outputs":[{"internalType":"uint256[15]","name":"","type":"uint256[15]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getReferralRequirements","outputs":[{"internalType":"uint256[15]","name":"","type":"uint256[15]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getSystemMetrics","outputs":[{"internalType":"uint256","name":"lastOperation","type":"uint256"},{"internalType":"uint256","name":"totalProcessed","type":"uint256"},{"internalType":"uint256","name":"efficiencyFactor","type":"uint256"},{"internalType":"uint256","name":"reservePool","type":"uint256"},{"internalType":"uint256","name":"operationSequence","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getTeamMembersCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalInvest","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalPaidOut","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalUser","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getUserInfo","outputs":[{"internalType":"uint256","name":"totalInvested","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn","type":"uint256"},{"internalType":"uint256","name":"activeInvestments","type":"uint256"},{"internalType":"uint256","name":"referralBonus","type":"uint256"},{"internalType":"uint256","name":"referralBonusWithdrawn","type":"uint256"},{"internalType":"uint256","name":"leadershipBonus","type":"uint256"},{"internalType":"uint256","name":"leadershipBonusWithdrawn","type":"uint256"},{"internalType":"address","name":"referrer","type":"address"},{"internalType":"uint256[15]","name":"referralLevels","type":"uint256[15]"},{"internalType":"uint256[3]","name":"leadershipLevels","type":"uint256[3]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getUserInvestments","outputs":[{"internalType":"uint256[]","name":"planIds","type":"uint256[]"},{"internalType":"uint256[]","name":"amounts","type":"uint256[]"},{"internalType":"uint256[]","name":"startTimes","type":"uint256[]"},{"internalType":"uint256[]","name":"lastClaimTimes","type":"uint256[]"},{"internalType":"uint256[]","name":"totalClaimeds","type":"uint256[]"},{"internalType":"bool[]","name":"actives","type":"bool[]"},{"internalType":"uint256[]","name":"pendingRewards","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"hasActiveDeposit","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_planId","type":"uint256"},{"internalType":"uint256","name":"_amount","type":"uint256"},{"internalType":"address","name":"_referrer","type":"address"}],"name":"invest","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"leadershipRates","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"leadershipRequirements","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"plans","outputs":[{"internalType":"uint256","name":"minDeposit","type":"uint256"},{"internalType":"uint256","name":"maxDeposit","type":"uint256"},{"internalType":"uint256","name":"dailyROI","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"totalReturn","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"referralExpiredBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"referralRates","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"referralRequirements","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalInvested","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalInvestors","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalLeadershipBonus","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalReferralBonus","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalWithdrawn","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"users","outputs":[{"internalType":"address","name":"referrer","type":"address"},{"internalType":"uint256","name":"totalInvested","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn","type":"uint256"},{"internalType":"uint256","name":"referralBonus","type":"uint256"},{"internalType":"uint256","name":"referralBonusWithdrawn","type":"uint256"},{"internalType":"uint256","name":"leadershipBonus","type":"uint256"},{"internalType":"uint256","name":"leadershipBonusWithdrawn","type":"uint256"},{"internalType":"bool","name":"registered","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"withdrawLeadership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawROI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawReferral","outputs":[],"stateMutability":"nonpayable","type":"function"}];

        let web3, contract, usdtContract, userAccount;
        let selectedPlan = null;
        let withdrawTimerInterval = null;

        // --- UI & Initialization ---
        window.addEventListener('load', () => {
            setTimeout(() => document.querySelector('.preloader').classList.add('fade-out'), 800);
            initWeb3Read();
            setupUI();
            checkUrlRef();
            generatePlans();
            generateRefLevels();
            generateLeadershipLevels();
        });

        function setupUI() {
            // Navigation
            document.querySelectorAll('[data-section]').forEach(el => {
                el.addEventListener('click', (e) => {
                    e.preventDefault();
                    showSection(el.dataset.section);
                    document.getElementById('nav-menu').classList.remove('active');
                });
            });
            
            document.getElementById('nav-toggle').addEventListener('click', () => {
                document.getElementById('nav-menu').classList.toggle('active');
            });

            // Buttons
            document.getElementById('connectWallet').addEventListener('click', connectWallet);
            document.getElementById('backToPlans').addEventListener('click', () => {
                document.getElementById('investmentPlans').style.display = 'grid';
                document.getElementById('investmentForm').style.display = 'none';
            });
            document.getElementById('investmentAmount').addEventListener('input', updateSummary);
            document.getElementById('confirmInvestment').addEventListener('click', executeInvest);
            document.getElementById('withdrawROI').addEventListener('click', () => executeWithdraw('ROI'));
            document.getElementById('withdrawReferral').addEventListener('click', () => executeWithdraw('Referral'));
            document.getElementById('withdrawLeadership').addEventListener('click', () => executeWithdraw('Leadership'));
            document.getElementById('copyLink').addEventListener('click', () => {
                navigator.clipboard.writeText(document.getElementById('referralLink').value);
                showToast('Referral link copied!', 'success');
            });
        }

        function showSection(id) {
            document.querySelectorAll('section').forEach(s => s.style.display = 'none');
            document.getElementById(id).style.display = 'block';
            document.querySelectorAll('.nav__link').forEach(l => l.classList.remove('active'));
            const activeLink = document.querySelector(`.nav__link[data-section="${id}"]`);
            if(activeLink) activeLink.classList.add('active');
            window.scrollTo(0,0);
        }

        function showToast(msg, type) {
            const el = document.getElementById('notification');
            el.textContent = msg;
            el.className = `notification show ${type}`;
            setTimeout(() => el.classList.remove('show'), 3000);
        }

        // --- Logic ---
        async function initWeb3Read() {
            web3 = new Web3(new Web3.providers.HttpProvider(RPC_URL));
            contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
            refreshGlobalStats();
        }

        async function connectWallet() {
            if (window.ethereum) {
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    web3 = new Web3(window.ethereum);
                    const accounts = await web3.eth.getAccounts();
                    userAccount = accounts[0];
                    contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
                    usdtContract = new web3.eth.Contract(USDT_ABI, USDT_ADDRESS);
                    
                    document.getElementById('connectWallet').innerHTML = `<i class="fas fa-user"></i> ${userAccount.substr(0,4)}...${userAccount.substr(-4)}`;
                    
                    // Update UI State
                    document.querySelectorAll('[id$="WalletAlert"]').forEach(e => e.style.display = 'none');
                    ['quickStats', 'actionButtons', 'referralStats', 'referralLinkSection', 'leadershipStats', 'leadershipActionButtons'].forEach(id => {
                        const el = document.getElementById(id);
                        if(el) el.style.display = id.includes('Grid') || id.includes('Stats') ? 'grid' : 'flex';
                        if(id === 'referralLinkSection') el.style.display = 'block';
                    });

                    loadUserData();
                    
                    // Listeners
                    window.ethereum.on('accountsChanged', () => window.location.reload());
                    window.ethereum.on('chainChanged', () => window.location.reload());

                } catch (error) {
                    showToast('Connection failed', 'error');
                }
            } else {
                showToast('Install MetaMask!', 'error');
            }
        }

        async function refreshGlobalStats() {
            try {
                const stats = await contract.methods.getPlatformStats().call();
                document.getElementById('statTvl').innerText = formatUSDT(stats.contractBalance) + ' USDT';
                document.getElementById('statTotalUsers').innerText = stats.totalInvestors_;
            } catch(e) { console.log('Read error', e); }
        }

        async function loadUserData() {
            if(!userAccount) return;
            try {
                const info = await contract.methods.getUserInfo(userAccount).call();
                const pending = await contract.methods.getPendingRewards(userAccount).call();
                const team = await contract.methods.getTeamMembersCount(userAccount).call();

                // Dashboard
                document.getElementById('totalInvested').innerText = formatUSDT(info.totalInvested) + ' USDT';
                document.getElementById('pendingRewards').innerText = formatUSDT(pending) + ' USDT';
                document.getElementById('totalEarnings').innerText = formatUSDT(new BigNumber(info.totalWithdrawn).plus(info.referralBonusWithdrawn)) + ' USDT';

                // Referral
                document.getElementById('referralBonusAmount').innerText = formatUSDT(info.referralBonus) + ' USDT';
                document.getElementById('referralTeamCount').innerText = team;
                document.getElementById('referralLink').value = `${window.location.origin}${window.location.pathname}?ref=${userAccount}`;

                // Leadership
                document.getElementById('leadershipBonusStats').innerText = formatUSDT(info.leadershipBonus) + ' USDT';

                startTimer();
            } catch(e) { console.error(e); }
        }

        // --- Plans & Interaction ---
        function generatePlans() {
            const plans = [
                {id:0, name:'Gold', roi:'16%', range:'10-100', days:7, color:'#FFD700', featured:false},
                {id:1, name:'Platinum', roi:'9%', range:'50-100', days:14, color:'#E5E4E2', featured:true},
                {id:2, name:'Diamond', roi:'5%', range:'100+', days:30, color:'#B9F2FF', featured:false}
            ];
            const html = plans.map(p => `
                <div class="glass-card plan-card ${p.featured?'featured':''}" onclick="openInvest(${p.id}, '${p.name}', ${p.id===2 ? 100 : 50}, ${p.id===2 ? 999999 : 100})">
                    ${p.featured ? '<div style="position:absolute; top:0; right:0; background:var(--primary); color:#fff; font-size:12px; padding:4px 10px; border-bottom-left-radius:10px;">POPULAR</div>' : ''}
                    <h3 style="color:${p.color}; margin-top:10px;">${p.name} Plan</h3>
                    <div class="plan-roi">${p.roi} <span style="font-size:1rem; font-weight:400; color:#fff;">Daily</span></div>
                    <ul class="plan-features" style="text-align:left; margin:20px 0;">
                        <li><i class="fas fa-check-circle"></i> Duration: ${p.days} Days</li>
                        <li><i class="fas fa-check-circle"></i> Min: ${p.range.split('-')[0]} USDT</li>
                        <li><i class="fas fa-check-circle"></i> Total ROI: ${parseInt(p.roi)*p.days}%</li>
                    </ul>
                    <button class="btn btn--outline" style="width:100%">Choose Plan</button>
                </div>
            `).join('');
            document.getElementById('investmentPlans').innerHTML = html;
        }

        function openInvest(id, name, min, max) {
            if(!userAccount) return showToast('Connect wallet first!', 'error');
            selectedPlan = { id, min, max };
            document.getElementById('planNameDisplay').innerText = name;
            document.getElementById('amountRange').innerText = `Min: ${min} USDT ${max>10000 ? '' : '- Max: '+max+' USDT'}`;
            document.getElementById('investmentPlans').style.display = 'none';
            document.getElementById('investmentForm').style.display = 'block';
            document.getElementById('investmentAmount').value = '';
            updateSummary();
        }

        function updateSummary() {
            const amt = parseFloat(document.getElementById('investmentAmount').value) || 0;
            const fee = amt * 0.1;
            document.getElementById('summaryAmount').innerText = amt.toFixed(2) + ' USDT';
            document.getElementById('summaryFee').innerText = fee.toFixed(2) + ' USDT';
            document.getElementById('summaryTotal').innerText = (amt + fee).toFixed(2) + ' USDT';
        }

        async function executeInvest() {
            const amt = document.getElementById('investmentAmount').value;
            if(!amt || amt < selectedPlan.min) return showToast('Invalid amount', 'error');
            
            const weiAmt = web3.utils.toWei(amt, 'ether');
            const ref = document.getElementById('referrerAddress').value || '0x0000000000000000000000000000000000000000';
            
            const btn = document.getElementById('confirmInvestment');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            
            try {
                // Approve
                const allowance = await usdtContract.methods.allowance(userAccount, CONTRACT_ADDRESS).call();
                if(new BigNumber(allowance).lt(weiAmt)) {
                    await usdtContract.methods.approve(CONTRACT_ADDRESS, '115792089237316195423570985008687907853269984665640564039457584007913129639935').send({from: userAccount});
                }
                // Invest
                await contract.methods.invest(selectedPlan.id, weiAmt, ref).send({from: userAccount});
                showToast('Investment Successful!', 'success');
                loadUserData();
                document.getElementById('backToPlans').click();
            } catch(e) {
                showToast('Transaction Failed', 'error');
            }
            btn.innerHTML = 'Confirm & Pay';
        }

        async function executeWithdraw(type) {
            try {
                const method = type === 'ROI' ? 'withdrawROI' : (type === 'Referral' ? 'withdrawReferral' : 'withdrawLeadership');
                await contract.methods[method]().send({from: userAccount});
                showToast(`${type} Withdraw Success!`, 'success');
                loadUserData();
            } catch(e) { showToast('Withdraw Failed', 'error'); }
        }

        // --- Helpers ---
        function formatUSDT(wei) {
            return parseFloat(web3.utils.fromWei(wei.toString(), 'ether')).toLocaleString(undefined, {minimumFractionDigits:2, maximumFractionDigits:2});
        }

        function checkUrlRef() {
            const urlParams = new URLSearchParams(window.location.search);
            const ref = urlParams.get('ref');
            if(ref && web3.utils.isAddress(ref)) {
                document.getElementById('referrerAddress').value = ref;
            }
        }

        function generateRefLevels() {
            const levels = [15,10,5,5,3,3,3,2,2,2,1,1,1,1,1];
            const html = levels.map((pct, i) => `
                <div style="min-width: 80px; text-align: center; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                    <div style="font-size: 0.8rem; color: var(--text-muted);">Lvl ${i+1}</div>
                    <div style="font-weight: bold; color: var(--secondary);">${pct}%</div>
                </div>
            `).join('');
            document.getElementById('referralLevelsCompact').innerHTML = html;
        }

        function generateLeadershipLevels() {
            const lvls = [
                {n:'Leader', b:'3%', req:'200'},
                {n:'Manager', b:'7%', req:'500'},
                {n:'Director', b:'10%', req:'1000'}
            ];
            document.getElementById('leadershipLevelsCompact').innerHTML = lvls.map((l, i) => `
                <div class="glass-card">
                    <div style="font-size:30px; color:var(--accent); margin-bottom:10px;">${i+1}</div>
                    <h3>${l.n}</h3>
                    <div style="font-size:1.5rem; color:var(--primary); font-weight:bold;">${l.b}</div>
                    <small>Req: ${l.req} Team</small>
                </div>
            `).join('');
        }

        function startTimer() {
            if(withdrawTimerInterval) clearInterval(withdrawTimerInterval);
            withdrawTimerInterval = setInterval(async () => {
                if(!contract || !userAccount) return;
                try {
                    const next = await contract.methods.getNextWithdrawTime(userAccount).call();
                    const now = Math.floor(Date.now()/1000);
                    const diff = next - now;
                    
                    const el = document.getElementById('withdrawTimer');
                    const btn = document.getElementById('withdrawROI');
                    
                    if(next == 0 || diff <= 0) {
                        el.style.display = 'none';
                        btn.removeAttribute('disabled');
                        btn.style.opacity = '1';
                    } else {
                        el.style.display = 'flex';
                        btn.setAttribute('disabled', 'true');
                        btn.style.opacity = '0.5';
                        
                        const h = Math.floor(diff/3600);
                        const m = Math.floor((diff%3600)/60);
                        const s = diff%60;
                        document.getElementById('timerHours').innerText = h < 10 ? '0'+h : h;
                        document.getElementById('timerMinutes').innerText = m < 10 ? '0'+m : m;
                        document.getElementById('timerSeconds').innerText = s < 10 ? '0'+s : s;
                    }
                } catch(e){}
            }, 1000);
        }

    </script>
</body>
</html>
