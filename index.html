<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexagon - Premium Investment Protocol</title>
    <link rel="icon" type="image/x-icon" href="image/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bignumber.js@9.1.2/bignumber.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <style>
        :root {
            /* New Color Palette: Premium Purple & Elegant Dark Black */
            --primary-black: #05020a;
            --secondary-black: #100a1f;
            --tertiary-black: #1c152e;
            --primary-purple: #9333ea; /* Violet-600 */
            --secondary-purple: #c084fc; /* Violet-400 */
            --accent-purple: #a855f7; /* Purple-500 */
            --light-purple: #f3e8ff;
            --white: #FFFFFF;
            --gray-100: #F5F5F5;
            --gray-200: #E5E5E5;
            --gray-300: #D4D4D3;
            --gray-400: #A3A3A3;
            --gray-500: #737373;
            --gray-600: #525252;
            --gray-700: #404040;
            --gray-800: #262626;
            --gray-900: #171717;

            --gradient-purple: linear-gradient(135deg, var(--primary-purple) 0%, var(--secondary-purple) 100%);
            --gradient-dark: linear-gradient(135deg, var(--primary-black) 0%, var(--secondary-black) 100%);
            --gradient-card: linear-gradient(135deg, rgba(147, 51, 234, 0.1) 0%, rgba(192, 132, 252, 0.05) 100%);
            --gradient-glass: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            --gradient-elegant: linear-gradient(145deg, rgba(28, 21, 46, 0.7), rgba(16, 10, 31, 0.7));

            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1);
            --shadow-purple: 0 0 20px rgba(147, 51, 234, 0.4);
            --shadow-purple-lg: 0 0 40px rgba(147, 51, 234, 0.5);
            --shadow-elegant: 0 8px 32px rgba(0, 0, 0, 0.3);

            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-heading: 'Montserrat', sans-serif;
            --font-size-xs: 0.75rem;
            --font-size-sm: 0.875rem;
            --font-size-base: 1rem;
            --font-size-lg: 1.125rem;
            --font-size-xl: 1.25rem;
            --font-size-2xl: 1.5rem;
            --font-size-3xl: 1.875rem;
            --font-size-4xl: 2.25rem;
            --font-size-5xl: 3rem;
            --font-size-6xl: 3.75rem;

            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
            --spacing-3xl: 4rem;
            --spacing-4xl: 6rem;

            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
            --radius-3xl: 2rem;

            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-primary);
            background-color: var(--primary-black);
            background-image: radial-gradient(circle at 10% 10%, rgba(147, 51, 234, 0.15), transparent 40%),
                              radial-gradient(circle at 90% 80%, rgba(147, 51, 234, 0.1), transparent 40%);
            color: var(--white);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--spacing-lg);
        }

        /* Preloader */
        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--primary-black);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity var(--transition-slow);
        }

        .preloader.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .loader {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-lg);
        }

        .purple-bar {
            width: 6px;
            height: 30px;
            background: var(--gradient-purple);
            border-radius: var(--radius-sm);
            animation: loader 1.2s ease-in-out infinite;
            box-shadow: var(--shadow-purple);
        }

        .purple-bar:nth-child(2) { animation-delay: 0.1s; }
        .purple-bar:nth-child(3) { animation-delay: 0.2s; }
        .purple-bar:nth-child(4) { animation-delay: 0.3s; }
        .purple-bar:nth-child(5) { animation-delay: 0.4s; }

        @keyframes loader {
            0%, 40%, 100% { transform: scaleY(1); }
            20% { transform: scaleY(2.5); }
        }

        .preloader-text {
            font-family: var(--font-heading);
            font-size: var(--font-size-xl);
            color: var(--primary-purple);
            letter-spacing: 2px;
            font-weight: 600;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(5, 2, 10, 0.85);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(147, 51, 234, 0.2);
            z-index: 1000;
            transition: all var(--transition-normal);
            box-shadow: var(--shadow-md);
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 80px;
            transition: all var(--transition-normal);
        }

        .nav__logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .logo {
            width: 40px; 
            height: 40px;
            filter: drop-shadow(0 0 10px rgba(147, 51, 234, 0.4));
            transition: transform var(--transition-normal);
        }
        .nav__logo:hover .logo {
            transform: rotate(-15deg);
        }

        .logo__text {
            font-family: var(--font-heading);
            font-size: var(--font-size-xl); 
            font-weight: 700;
            background: var(--gradient-purple);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 1px;
        }

        .nav__menu {
            display: flex;
            align-items: center;
            gap: var(--spacing-2xl);
        }

        .nav__list {
            display: flex;
            gap: var(--spacing-xl);
            list-style: none;
        }

        .nav__link {
            color: var(--gray-300);
            text-decoration: none;
            font-weight: 500;
            transition: all var(--transition-fast);
            position: relative;
            cursor: pointer;
            font-size: var(--font-size-base);
            letter-spacing: 0.5px;
            padding: var(--spacing-sm) 0;
        }

        .nav__link::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--gradient-purple);
            box-shadow: var(--shadow-purple);
            transform: scaleX(0);
            transform-origin: right;
            transition: transform var(--transition-normal);
        }

        .nav__link:hover,
        .nav__link.active {
            color: var(--secondary-purple);
            transform: translateY(-2px);
        }

        .nav__link:hover::after,
        .nav__link.active::after {
            transform: scaleX(1);
            transform-origin: left;
        }

        .nav__toggle {
            display: none;
            font-size: var(--font-size-xl);
            cursor: pointer;
            color: var(--primary-purple);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md) var(--spacing-xl);
            border: none;
            border-radius: var(--radius-lg);
            font-size: var(--font-size-base);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
            letter-spacing: 0.5px;
        }

        .btn--primary {
            background: var(--gradient-purple);
            color: var(--white);
            box-shadow: var(--shadow-purple);
        }

        .btn--primary:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: var(--shadow-purple-lg);
        }

        .btn--outline {
            background: transparent;
            color: var(--white);
            border: 2px solid var(--primary-purple);
        }

        .btn--outline:hover {
            background: rgba(147, 51, 234, 0.1);
            transform: translateY(-3px);
            color: var(--secondary-purple);
        }

        .btn--secondary {
            background: var(--tertiary-black);
            color: var(--white);
            border: 1px solid var(--gray-600);
        }

        .btn--secondary:hover {
            background: var(--gray-700);
            transform: translateY(-3px);
        }

        .btn i {
            font-size: var(--font-size-lg);
        }

        .btn-sm {
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: var(--font-size-sm);
        }

        .btn-lg {
            padding: var(--spacing-lg) var(--spacing-2xl);
            font-size: var(--font-size-lg);
        }

        /* Sections */
        .section {
            padding: var(--spacing-4xl) 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            text-align: center;
        }
        
        #home.section, #statistics.section {
            min-height: auto;
        }
        
        #home {
            padding-top: 120px;
            padding-bottom: var(--spacing-2xl);
        }

        #statistics {
            padding-top: 120px; /* Fixed padding for statistics section */
        }

        .section .container {
            width: 100%;
        }

        .section__title {
            font-family: var(--font-heading);
            font-size: var(--font-size-5xl);
            text-align: center;
            margin-bottom: var(--spacing-md);
            background: var(--gradient-purple);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 1px;
            font-weight: 700;
        }

        .section__subtitle {
            font-size: var(--font-size-xl);
            text-align: center;
            color: var(--gray-400);
            margin-bottom: var(--spacing-3xl);
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.7;
        }

        .gradient-text {
            background: var(--gradient-purple);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Hero Section */
        @keyframes fadeIn-up {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hero {
            background: var(--gradient-dark);
            position: relative;
            overflow: hidden;
            min-height: 100vh;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 50%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(147, 51, 234, 0.15) 0%, transparent 70%);
        }

        .hero::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary-purple), transparent);
        }

        .hero__container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-3xl);
            align-items: center;
        }

        .hero__content {
            text-align: left;
        }

        .hero__badge {
            margin-bottom: var(--spacing-lg);
            animation: fadeIn-up 0.6s ease-out 0.2s backwards;
        }

        .badge {
            display: inline-block;
            padding: var(--spacing-sm) var(--spacing-md);
            background: rgba(147, 51, 234, 0.1);
            border: 1px solid var(--primary-purple);
            border-radius: var(--radius-lg);
            color: var(--secondary-purple);
            font-size: var(--font-size-sm);
            font-weight: 600;
            letter-spacing: 1px;
        }

        .hero__title {
            font-family: var(--font-heading);
            font-size: var(--font-size-6xl);
            margin-bottom: var(--spacing-lg);
            line-height: 1.1;
            letter-spacing: 1px;
            font-weight: 800;
            text-shadow: 0 0 15px rgba(147, 51, 234, 0.3);
            animation: fadeIn-up 0.6s ease-out 0.4s backwards;
        }

        .hero__description {
            font-size: var(--font-size-xl);
            color: var(--gray-300);
            margin-bottom: var(--spacing-2xl);
            max-width: 500px;
            line-height: 1.7;
            animation: fadeIn-up 0.6s ease-out 0.6s backwards;
        }

        .hero__buttons {
            display: flex;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-3xl);
            animation: fadeIn-up 0.6s ease-out 0.8s backwards;
        }

        .hero__image {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .floating-card {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-2xl);
            backdrop-filter: blur(20px);
            box-shadow: var(--shadow-elegant);
            animation: float 6s ease-in-out infinite;
            width: 100%;
            max-width: 450px;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }

        .card__header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid rgba(147, 51, 234, 0.2);
        }

        .card__header h3 {
            margin: 0;
            color: var(--white);
            font-size: var(--font-size-lg);
            font-weight: 600;
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            font-size: var(--font-size-sm);
            color: var(--secondary-purple);
            font-weight: 600;
        }

        .dot {
            width: 8px;
            height: 8px;
            background: var(--secondary-purple);
            border-radius: 50%;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px var(--secondary-purple);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md) 0;
            border-bottom: 1px solid rgba(147, 51, 234, 0.1);
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-item .label {
            color: var(--gray-300);
        }
        
        .stat-item .value {
            color: var(--secondary-purple);
            font-weight: 600;
            font-family: var(--font-heading);
            font-size: var(--font-size-lg);
        }

        /* Statistics Section */
        #statistics {
            background: var(--gradient-dark);
            min-height: 100vh;
        }

        .statistics-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: var(--spacing-2xl);
            margin-top: var(--spacing-xl);
            width: 100%;
            max-width: 1000px;
        }

        .stats-box {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-xl);
            backdrop-filter: blur(15px);
            box-shadow: var(--shadow-elegant);
            text-align: left;
        }

        .stats-box__header {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid rgba(147, 51, 234, 0.2);
        }

        .stats-box__header i {
            font-size: var(--font-size-xl);
            color: var(--primary-purple);
        }
        .stats-box__header h3 {
            font-family: var(--font-heading);
            color: var(--white);
            font-size: var(--font-size-lg);
            font-weight: 600;
        }

        .stats-box__list {
            max-height: 300px;
            overflow-y: auto;
            padding-right: var(--spacing-sm);
        }

        /* Custom scrollbar for stats list */
        .stats-box__list::-webkit-scrollbar {
            width: 6px;
        }
        .stats-box__list::-webkit-scrollbar-track {
            background: rgba(147, 51, 234, 0.1);
            border-radius: var(--radius-sm);
        }
        .stats-box__list::-webkit-scrollbar-thumb {
            background: var(--primary-purple);
            border-radius: var(--radius-sm);
        }

        .stat-entry {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: var(--spacing-sm) var(--spacing-md);
            padding: var(--spacing-md) 0;
            border-bottom: 1px solid rgba(147, 51, 234, 0.1);
            font-size: var(--font-size-sm);
        }
        .stat-entry:last-child {
            border-bottom: none;
        }

        .stat-entry__address {
            color: var(--gray-300);
            font-family: monospace;
        }
        .stat-entry__time {
            color: var(--gray-500);
            font-size: var(--font-size-xs);
            grid-column: 1 / 2;
        }
        .stat-entry__amount {
            color: var(--secondary-purple);
            font-weight: 600;
            font-size: var(--font-size-base);
            grid-row: 1 / 3;
            grid-column: 2 / 3;
            align-self: center;
            text-align: right;
        }

        /* Dashboard Section */
        .dashboard-section {
            background: var(--secondary-black);
            min-height: 100vh;
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-3xl);
            text-align: left;
        }

        .stat-card {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-2xl);
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
            transition: all var(--transition-normal);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-elegant);
        }

        .stat-card:hover {
            border-color: var(--primary-purple);
            transform: translateY(-5px);
            box-shadow: var(--shadow-purple-lg);
        }

        .stat-icon {
            width: 70px;
            height: 70px;
            background: var(--gradient-purple);
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-2xl);
            color: var(--white);
            box-shadow: var(--shadow-purple);
            flex-shrink: 0;
        }

        .stat-value {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            color: var(--primary-purple);
            margin-bottom: var(--spacing-xs);
            font-family: var(--font-heading);
        }

        .stat-label {
            color: var(--gray-400);
            font-size: var(--font-size-sm);
            letter-spacing: 0.5px;
        }

        .action-buttons {
            display: flex;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-3xl);
            flex-wrap: wrap;
            justify-content: center;
        }

        .empty-state {
            text-align: center;
            padding: var(--spacing-4xl);
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-2xl);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-elegant);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .empty-icon {
            width: 100px;
            height: 100px;
            background: var(--gradient-purple);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-3xl);
            color: var(--white);
            margin: 0 auto var(--spacing-lg);
            box-shadow: var(--shadow-purple);
        }

        .empty-state h3 {
            margin-bottom: var(--spacing-md);
            color: var(--white);
            font-family: var(--font-heading);
            font-size: var(--font-size-2xl);
        }

        .empty-state p {
            color: var(--gray-400);
            margin-bottom: var(--spacing-xl);
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        /* Invest Section */
        .invest-section {
            background: var(--primary-black);
            min-height: 100vh;
        }

        .investment-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: var(--spacing-2xl);
            margin-bottom: var(--spacing-3xl);
        }

        .plan-card {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-2xl);
            text-align: center;
            transition: all var(--transition-normal);
            position: relative;
            cursor: pointer;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-elegant);
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .plan-card:hover {
            border-color: var(--primary-purple);
            transform: translateY(-10px);
            box-shadow: var(--shadow-purple-lg);
        }

        .plan-card.featured {
            border-color: var(--primary-purple);
            box-shadow: var(--shadow-purple-lg);
            transform: scale(1.05);
        }

        .plan-card.featured::before {
            content: 'RECOMMENDED';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--gradient-purple);
            color: var(--white);
            padding: var(--spacing-xs) var(--spacing-lg);
            border-radius: var(--radius-lg);
            font-size: var(--font-size-sm);
            font-weight: 700;
            letter-spacing: 1px;
            box-shadow: var(--shadow-purple);
        }

        .plan-card.featured:hover {
            transform: scale(1.05) translateY(-10px);
        }

        .plan-badge {
            position: absolute;
            top: var(--spacing-lg);
            right: var(--spacing-lg);
            background: rgba(147, 51, 234, 0.1);
            color: var(--primary-purple);
            padding: var(--spacing-xs) var(--spacing-md);
            border-radius: var(--radius-lg);
            font-size: var(--font-size-sm);
            font-weight: 600;
        }

        .plan-name {
            font-size: var(--font-size-xl);
            margin-bottom: var(--spacing-md);
            color: var(--white);
            font-family: var(--font-heading);
        }

        .plan-roi {
            font-size: var(--font-size-3xl);
            font-weight: 700;
            color: var(--primary-purple);
            margin-bottom: var(--spacing-md);
            font-family: var(--font-heading);
        }

        .plan-range {
            background: rgba(147, 51, 234, 0.1);
            padding: var(--spacing-md);
            border-radius: var(--radius-lg);
            margin: var(--spacing-lg) 0;
            font-weight: 600;
            color: var(--secondary-purple);
            border: 1px solid rgba(147, 51, 234, 0.2);
        }

        .plan-duration {
            color: var(--gray-400);
            margin-bottom: var(--spacing-md);
            font-size: var(--font-size-sm);
        }

        .plan-total {
            font-size: var(--font-size-lg);
            color: var(--light-purple);
            margin-bottom: var(--spacing-xl);
            font-weight: 600;
        }

        .plan-features {
            list-style: none;
            margin: var(--spacing-lg) 0;
            text-align: left;
            flex-grow: 1;
        }

        .plan-features li {
            padding: var(--spacing-sm) 0;
            color: var(--gray-300);
            border-bottom: 1px solid rgba(147, 51, 234, 0.1);
            display: flex;
            align-items: center;
        }

        .plan-features li:last-child {
            border-bottom: none;
        }

        .plan-features li i {
            color: var(--primary-purple);
            margin-right: var(--spacing-sm);
            font-size: var(--font-size-sm);
        }

        .investment-form-container {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-3xl);
            margin-bottom: var(--spacing-3xl);
            display: none;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-elegant);
            width: 100%;
            max-width: 600px;
        }

        .investment-form-container.active {
            display: block;
        }

        .form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-2xl);
            padding-bottom: var(--spacing-lg);
            border-bottom: 1px solid rgba(147, 51, 234, 0.1);
        }

        .form-header h2 {
            margin: 0;
            color: var(--white);
            font-family: var(--font-heading);
            font-size: var(--font-size-3xl);
        }

        .investment-form {
            max-width: 500px;
            margin: 0 auto;
            text-align: left;
        }

        .form-group {
            margin-bottom: var(--spacing-xl);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--spacing-sm);
            color: var(--white);
            font-weight: 600;
            font-size: var(--font-size-lg);
        }

        .form-input {
            width: 100%;
            padding: var(--spacing-lg);
            background: rgba(5, 2, 10, 0.8);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: var(--radius-lg);
            color: var(--white);
            font-size: var(--font-size-base);
            transition: all var(--transition-normal);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 3px rgba(147, 51, 234, 0.1);
        }

        .amount-range {
            margin-top: var(--spacing-sm);
            font-size: var(--font-size-sm);
            color: var(--gray-400);
        }

        .plan-summary {
            background: rgba(147, 51, 234, 0.1);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            color: var(--white);
        }

        .plan-summary .plan-name {
            font-size: var(--font-size-lg);
            margin-bottom: var(--spacing-sm);
        }

        .plan-summary .plan-roi {
            font-size: var(--font-size-xl);
            margin-bottom: var(--spacing-sm);
        }

        .investment-summary {
            background: rgba(5, 2, 10, 0.8);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            margin: var(--spacing-2xl) 0;
        }

        .investment-summary h3 {
            margin-bottom: var(--spacing-lg);
            color: var(--white);
            text-align: center;
            font-family: var(--font-heading);
            font-size: var(--font-size-xl);
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md) 0;
            border-bottom: 1px solid rgba(147, 51, 234, 0.1);
            color: var(--gray-300);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-item.total {
            font-weight: 700;
            color: var(--primary-purple);
            font-size: var(--font-size-lg);
        }

        /* Investment Success Popup */
        .investment-success-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-normal);
        }

        .investment-success-popup.active {
            opacity: 1;
            visibility: visible;
        }

        .investment-success {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-2xl);
            text-align: center;
            max-width: 450px;
            width: 90%;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-elegant);
            transform: scale(0.9);
            transition: transform var(--transition-normal);
        }

        .investment-success-popup.active .investment-success {
            transform: scale(1);
        }

        .success-icon {
            width: 90px;
            height: 90px;
            background: var(--gradient-purple);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-3xl);
            color: var(--white);
            margin: 0 auto var(--spacing-lg);
            box-shadow: var(--shadow-purple);
        }

        .investment-success h2 {
            margin-bottom: var(--spacing-md);
            color: var(--white);
            font-family: var(--font-heading);
            font-size: var(--font-size-2xl);
        }

        .investment-success p {
            color: var(--gray-400);
            margin-bottom: var(--spacing-xl);
            line-height: 1.6;
            font-size: var(--font-size-lg);
        }

        .success-actions {
            display: flex;
            gap: var(--spacing-md);
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Referral Section */
        .referral-section {
            background: var(--secondary-black);
            min-height: 100vh;
        }

        .referral-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-3xl);
            text-align: left;
        }

        .referral-link-container {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-3xl);
            margin-bottom: var(--spacing-3xl);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-elegant);
            width: 100%;
            max-width: 800px;
        }

        .referral-link-container h2 {
            text-align: center;
            font-family: var(--font-heading);
            color: var(--white);
            font-size: var(--font-size-2xl);
            margin-bottom: var(--spacing-sm);
        }

        .referral-link-container p {
            text-align: center;
            color: var(--gray-400);
            margin-bottom: var(--spacing-xl);
        }

        .link-display {
            display: flex;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .link-input {
            flex: 1;
            padding: var(--spacing-lg);
            background: rgba(5, 2, 10, 0.8);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: var(--radius-lg);
            color: var(--white);
            font-size: var(--font-size-base);
        }

        .social-share {
            display: flex;
            justify-content: center;
            gap: var(--spacing-md);
        }

        .social-btn {
            width: 60px;
            height: 60px;
            background: rgba(147, 51, 234, 0.1);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-lg);
            color: var(--secondary-purple);
            font-size: var(--font-size-xl);
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .social-btn:hover {
            background: var(--primary-purple);
            color: var(--white);
            transform: translateY(-5px);
            box-shadow: var(--shadow-purple);
        }

        .levels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-2xl);
            margin-bottom: var(--spacing-3xl);
            text-align: left;
        }

        .level-card {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-2xl);
            transition: all var(--transition-normal);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-elegant);
            position: relative;
        }
        
        .level-card.locked {
            background: rgba(10, 10, 10, 0.5);
            border-color: rgba(128,128,128,0.2);
        }
        .level-card.locked .level-header,
        .level-card.locked .level-requirements {
             opacity: 0.5;
        }
        
        .lock-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            color: rgba(255, 255, 255, 0.2);
            z-index: 5;
        }

        .level-card:hover {
            border-color: var(--primary-purple);
            transform: translateY(-10px);
            box-shadow: var(--shadow-purple-lg);
        }
        
        .level-card.locked:hover {
             border-color: rgba(128,128,128,0.4);
             transform: translateY(0);
             box-shadow: var(--shadow-elegant);
        }

        .level-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid rgba(147, 51, 234, 0.1);
        }
        
        .level-card.locked .level-header {
            border-color: rgba(128,128,128,0.1);
        }

        .level-number {
            width: 50px;
            height: 50px;
            background: var(--gradient-purple);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: 700;
            font-size: var(--font-size-xl);
            box-shadow: var(--shadow-purple);
            flex-shrink: 0;
        }
        
        .level-card.locked .level-number {
            background: var(--gray-700);
            box-shadow: none;
        }

        .level-commission {
            font-size: var(--font-size-xl);
            font-weight: 700;
            color: var(--primary-purple);
            font-family: var(--font-heading);
            text-align: right;
        }
        
        .level-card.locked .level-commission {
            color: var(--gray-400);
        }

        .level-requirements {
            margin-bottom: var(--spacing-lg);
            padding-top: var(--spacing-md);
        }

        .requirement {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
            color: var(--gray-300);
            font-size: var(--font-size-sm);
        }

        .requirement i {
            color: var(--primary-purple);
        }
        .level-card.locked .requirement i {
            color: var(--gray-500);
        }

        /* Leadership Section */
        .leadership-section {
            background: var(--primary-black);
            min-height: 100vh;
        }

        .leadership-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-3xl);
            text-align: left;
        }

        .leadership-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: var(--spacing-2xl);
            margin-bottom: var(--spacing-3xl);
            text-align: left;
        }

        .leadership-card {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-2xl);
            transition: all var(--transition-normal);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-elegant);
            position: relative;
            text-align: center;
        }
        
        .leadership-card.locked {
            background: rgba(10, 10, 10, 0.5);
            border-color: rgba(128,128,128,0.2);
        }
        .leadership-card.locked .leadership-header,
        .leadership-card.locked .leadership-requirements {
             opacity: 0.5;
        }
        
        .leadership-card:hover {
            border-color: var(--primary-purple);
            transform: translateY(-10px);
            box-shadow: var(--shadow-purple-lg);
        }
        
        .leadership-card.locked:hover {
             border-color: rgba(128,128,128,0.4);
             transform: translateY(0);
             box-shadow: var(--shadow-elegant);
        }

        .leadership-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid rgba(147, 51, 234, 0.1);
        }
        
        .leadership-card.locked .leadership-header {
            border-color: rgba(128,128,128,0.1);
        }

        .leadership-level {
            width: 70px;
            height: 70px;
            background: var(--gradient-purple);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: 700;
            font-size: var(--font-size-2xl);
            box-shadow: var(--shadow-purple);
            margin-bottom: var(--spacing-md);
        }
        
        .leadership-card.locked .leadership-level {
            background: var(--gray-700);
            box-shadow: none;
        }

        .leadership-title {
            font-size: var(--font-size-xl);
            font-weight: 700;
            color: var(--white);
            font-family: var(--font-heading);
            margin-bottom: var(--spacing-sm);
        }

        .leadership-bonus {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            color: var(--primary-purple);
            font-family: var(--font-heading);
        }
        
        .leadership-card.locked .leadership-bonus {
            color: var(--gray-400);
        }

        .leadership-requirements {
            margin-bottom: var(--spacing-lg);
            padding-top: var(--spacing-md);
        }

        .leadership-requirement {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
            color: var(--gray-300);
            font-size: var(--font-size-base);
        }

        .leadership-requirement i {
            color: var(--primary-purple);
        }
        .leadership-card.locked .leadership-requirement i {
            color: var(--gray-500);
        }

        .bonus-claim-section {
            margin-bottom: var(--spacing-3xl);
        }

        .claim-card {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-3xl);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: var(--spacing-2xl);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-elegant);
        }

        .claim-info h3 {
            margin-bottom: var(--spacing-sm);
            color: var(--white);
            font-family: var(--font-heading);
            font-size: var(--font-size-2xl);
        }

        .claim-info p {
            color: var(--gray-400);
            margin-bottom: var(--spacing-md);
            line-height: 1.6;
        }

        .bonus-amount {
            font-size: var(--font-size-4xl);
            font-weight: 700;
            color: var(--primary-purple);
            font-family: var(--font-heading);
        }

        /* FAQ Section */
        .faq-section {
            background: var(--secondary-black);
            min-height: 100vh;
        }

        .faq-container {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            text-align: left;
        }

        .faq-item {
            background: var(--gradient-elegant);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: var(--radius-xl);
            margin-bottom: var(--spacing-lg);
            overflow: hidden;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-elegant);
        }

        .faq-question {
            padding: var(--spacing-xl);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .faq-question:hover {
            background: rgba(147, 51, 234, 0.05);
        }

        .faq-question h3 {
            margin: 0;
            color: var(--white);
            font-size: var(--font-size-lg);
            font-weight: 600;
        }

        .faq-icon {
            color: var(--primary-purple);
            transition: transform var(--transition-normal);
            font-size: var(--font-size-lg);
        }

        .faq-answer {
            padding: 0 var(--spacing-xl);
            max-height: 0;
            overflow: hidden;
            transition: all var(--transition-normal);
            color: var(--gray-300);
            line-height: 1.6;
        }

        .faq-item.active .faq-answer {
            padding: 0 var(--spacing-xl) var(--spacing-xl);
            max-height: 500px;
        }

        .faq-item.active .faq-icon {
            transform: rotate(180deg);
        }

        /* Alert */
        .alert {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-lg);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-2xl);
            border: 1px solid;
            backdrop-filter: blur(10px);
            max-width: 800px;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            text-align: left;
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.1);
            border-color: #F59E0B;
            color: #F59E0B;
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border-color: #10B981;
            color: #10B981;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: var(--spacing-lg) var(--spacing-xl);
            background: var(--secondary-black);
            border: 1px solid var(--primary-purple);
            border-radius: var(--radius-lg);
            color: var(--white);
            box-shadow: var(--shadow-lg);
            transform: translateX(150%);
            transition: transform var(--transition-normal);
            z-index: 3000;
            max-width: 400px;
            backdrop-filter: blur(10px);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-color: #10B981;
            background: rgba(16, 185, 129, 0.1);
        }

        .notification.error {
            border-color: #EF4444;
            background: rgba(239, 68, 68, 0.1);
        }

        /* Footer */
        .footer {
            background: var(--primary-black);
            border-top: 1px solid rgba(147, 51, 234, 0.1);
            padding: var(--spacing-4xl) 0 var(--spacing-xl);
            min-height: auto;
        }

        .footer__content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: var(--spacing-3xl);
            margin-bottom: var(--spacing-2xl);
            text-align: left;
        }

        .footer__brand {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .footer__logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: var(--font-size-xl);
            font-weight: 700;
            color: var(--primary-purple);
            font-family: var(--font-heading);
        }

        .footer__logo img {
            width: 35px;
            height: 35px;
            filter: drop-shadow(0 0 10px rgba(147, 51, 234, 0.3));
        }

        .footer__description {
            color: var(--gray-400);
            line-height: 1.6;
        }

        .footer__social {
            display: flex;
            gap: var(--spacing-md);
        }

        .social__link {
            width: 45px;
            height: 45px;
            background: rgba(147, 51, 234, 0.1);
            border: 1px solid var(--primary-purple);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-purple);
            text-decoration: none;
            transition: all var(--transition-normal);
        }

        .social__link:hover {
            background: var(--primary-purple);
            color: var(--white);
            transform: translateY(-3px);
            box-shadow: var(--shadow-purple);
        }

        .footer__links {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-2xl);
        }

        .footer__column h4 {
            color: var(--white);
            margin-bottom: var(--spacing-lg);
            font-size: var(--font-size-lg);
            font-family: var(--font-heading);
        }

        .footer__column a {
            display: block;
            color: var(--gray-400);
            text-decoration: none;
            margin-bottom: var(--spacing-sm);
            transition: color var(--transition-fast);
        }

        .footer__column a:hover {
            color: var(--primary-purple);
        }

        .footer__bottom {
            border-top: 1px solid rgba(147, 51, 234, 0.1);
            padding-top: var(--spacing-lg);
            text-align: center;
            color: var(--gray-500);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .hero__container {
                grid-template-columns: 1fr;
                gap: var(--spacing-2xl);
                text-align: center;
            }

            .hero__content {
                text-align: center;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .hero__buttons {
                justify-content: center;
            }

            .footer__content {
                grid-template-columns: 1fr;
                gap: var(--spacing-2xl);
                text-align: center;
            }
            .footer__brand {
                align-items: center;
            }
        }

        @media (max-width: 768px) {
            .nav {
                height: 72px;
            }

            .nav__menu {
                position: fixed;
                top: 72px;
                left: -100%;
                width: 80%;
                height: calc(100vh - 72px);
                background: var(--secondary-black);
                flex-direction: column;
                justify-content: flex-start;
                align-items: flex-start;
                padding: var(--spacing-xl);
                transition: left var(--transition-normal);
                border-right: 1px solid rgba(147, 51, 234, 0.1);
                backdrop-filter: blur(20px);
            }

            .nav__menu.active {
                left: 0;
            }

            .nav__list {
                flex-direction: column;
                gap: var(--spacing-lg);
                width: 100%;
            }

            .nav__buttons {
                width: 100%;
                margin-top: var(--spacing-xl);
            }

            .nav__toggle {
                display: block;
                font-size: var(--font-size-2xl);
            }

            .logo {
                width: 35px;
                height: 35px;
            }
            
            .logo__text {
                font-size: var(--font-size-lg);
            }
            
            .hero__title {
                font-size: var(--font-size-4xl);
            }

            .hero__buttons {
                flex-direction: column;
                align-items: center;
                width: 100%;
                max-width: 300px;
            }
            .hero__buttons .btn {
                width: 100%;
            }
            
            .statistics-container {
                grid-template-columns: 1fr;
            }

            .investment-plans {
                grid-template-columns: 1fr;
            }

            .plan-card.featured {
                transform: none;
            }

            .plan-card.featured:hover {
                transform: translateY(-10px);
            }

            .form-header {
                flex-direction: column;
                gap: var(--spacing-md);
                align-items: flex-start;
            }

            .success-actions {
                flex-direction: column;
                align-items: center;
                width: 100%;
            }
            .success-actions .btn {
                width: 80%;
            }

            .referral-stats, .leadership-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .levels-grid, .leadership-grid {
                grid-template-columns: 1fr;
            }

            .link-display {
                flex-direction: column;
            }

            .claim-card {
                flex-direction: column;
                text-align: center;
                gap: var(--spacing-lg);
            }

            .footer__links {
                grid-template-columns: 1fr;
                gap: var(--spacing-xl);
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 var(--spacing-md);
            }

            .hero__title {
                font-size: var(--font-size-3xl);
            }

            .section__title {
                font-size: var(--font-size-3xl);
            }

            .btn {
                padding: var(--spacing-md) var(--spacing-lg);
                font-size: var(--font-size-sm);
            }

            .referral-stats, .leadership-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Preloader -->
    <div class="preloader">
        <div class="loader">
            <div class="purple-bar"></div>
            <div class="purple-bar"></div>
            <div class="purple-bar"></div>
            <div class="purple-bar"></div>
            <div class="purple-bar"></div>
        </div>
        <div class="preloader-text">NEXAGON</div>
    </div>

    <!-- Header -->
    <header class="header">
        <nav class="nav container">
            <div class="nav__logo">
                <img src="image/logo.png" alt="Nexagon Logo" class="logo">
                <div class="logo__text">NEXAGON</div>
            </div>

            <div class="nav__menu" id="nav-menu">
                <ul class="nav__list">
                    <li class="nav__item">
                        <a class="nav__link active" data-section="home">Home</a>
                    </li>
                    <li class="nav__item">
                        <a class="nav__link" data-section="statistics">Statistics</a>
                    </li>
                    <li class="nav__item">
                        <a class="nav__link" data-section="dashboard">Dashboard</a>
                    </li>
                    <li class="nav__item">
                        <a class="nav__link" data-section="invest">Invest</a>
                    </li>
                    <li class="nav__item">
                        <a class="nav__link" data-section="referral">Referral</a>
                    </li>
                    <li class="nav__item">
                        <a class="nav__link" data-section="leadership">Leadership</a>
                    </li>
                    <li class="nav__item">
                        <a class="nav__link" data-section="faq">FAQ</a>
                    </li>
                </ul>

                <div class="nav__buttons">
                    <button class="btn btn--outline" id="connectWallet">
                        <i class="fas fa-wallet"></i>
                        Connect Wallet
                    </button>
                </div>
            </div>

            <div class="nav__toggle" id="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Home Section -->
        <section class="hero section" id="home">
            <div class="hero__container container">
                <div class="hero__content">
                    <div class="hero__badge">
                        <span class="badge">Advanced DeFi Investment Platform</span>
                    </div>
                    <h1 class="hero__title">
                        <span class="gradient-text">Nexagon </span> 
                         Next Generation Investment Protocol
                    </h1>
                    <p class="hero__description">
                        Experience premium decentralized finance with Nexagon's advanced investment protocol. Earn stable daily returns through our optimized ROI system, backed by a 15-level referral program and secure smart contract technology.
                    </p>
                    <div class="hero__buttons">
                        <button class="btn btn--primary" data-section="invest">
                            <i class="fas fa-rocket"></i>
                            Start Investing
                        </button>
                        <button class="btn btn--outline" data-section="dashboard">
                            <i class="fas fa-chart-line"></i>
                            View Dashboard
                        </button>
                    </div>
                </div>
                <div class="hero__image">
                    <div class="floating-card">
                        <div class="card__header">
                            <h3>Live Contract Stats</h3>
                            <div class="live-indicator">
                                <span class="dot"></span>
                                LIVE
                            </div>
                        </div>
                        <div class="card__content">
                            <div class="stat-item">
                                <span class="label">TVL</span>
                                <span class="value" id="statTvl">Loading...</span>
                            </div>
                            <div class="stat-item">
                                <span class="label">Total User</span>
                                <span class="value" id="statTotalUsers">Loading...</span>
                            </div>
                            <div class="stat-item">
                                <span class="label">Total Deposit</span>
                                <span class="value" id="statTotalDeposit">Loading...</span>
                            </div>
                            <div class="stat-item">
                                <span class="label">Total Paid Out</span>
                                <span class="value" id="statTotalPaidOut">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Real-time Blockchain Statistics Section -->
        <section class="section" id="statistics" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h2 class="section__title">Real-time Blockchain Statistics</h2>
                    <p class="section__subtitle">We believe in absolute transparency. All data below is fetched directly from the smart contract.</p>
                </div>
                
                <div class="statistics-container">
                    <!-- Deposits Box -->
                    <div class="stats-box">
                        <div class="stats-box__header">
                            <i class="fas fa-arrow-down"></i>
                            <h3>Latest Deposits</h3>
                        </div>
                        <div class="stats-box__list" id="latest-deposits">
                            <!-- Data will be populated by JavaScript -->
                            <div class="stat-entry">
                                <span class="stat-entry__address">Loading deposits...</span>
                                <span class="stat-entry__time"></span>
                                <span class="stat-entry__amount"></span>
                            </div>
                        </div>
                    </div>
                    <!-- Withdrawals Box -->
                    <div class="stats-box">
                         <div class="stats-box__header">
                            <i class="fas fa-arrow-up"></i>
                            <h3>Latest Withdrawals</h3>
                        </div>
                         <div class="stats-box__list" id="latest-withdrawals">
                            <!-- Data will be populated by JavaScript -->
                            <div class="stat-entry">
                                <span class="stat-entry__address">Loading withdrawals...</span>
                                <span class="stat-entry__time"></span>
                                <span class="stat-entry__amount"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- Dashboard Section -->
        <section class="dashboard-section section" id="dashboard" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h2 class="section__title">Your Dashboard</h2>
                    <p class="section__subtitle">Monitor your investments and earnings in real-time with our premium analytics</p>
                </div>

                <div class="alert alert-warning" id="dashboardWalletAlert">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Please connect your wallet to view your dashboard</span>
                </div>

                <div class="quick-stats" id="quickStats" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalInvested">0 USDT</div>
                            <div class="stat-label">Total Invested</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="pendingRewards">0 USDT</div>
                            <div class="stat-label">Pending Rewards</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalWithdrawn">0 USDT</div>
                            <div class="stat-label">Total Withdrawn</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-gift"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="referralBonus">0 USDT</div>
                            <div class="stat-label">Referral Earnings</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="leadershipBonus">0 USDT</div>
                            <div class="stat-label">Leadership Bonus</div>
                        </div>
                    </div>
                </div>

                <div class="action-buttons" id="actionButtons" style="display: none;">
                    <button class="btn btn--primary" data-section="invest">
                        <i class="fas fa-rocket"></i>
                        Start Investing
                    </button>
                    <button class="btn btn--outline" id="withdrawROI">
                        <i class="fas fa-download"></i>
                        Withdraw ROI
                    </button>
                    <button class="btn btn--outline" id="withdrawReferral">
                        <i class="fas fa-gift"></i>
                        Withdraw Referral
                    </button>
                    <button class="btn btn--outline" id="withdrawLeadership">
                        <i class="fas fa-crown"></i>
                        Withdraw Leadership
                    </button>
                </div>
                
                <div class="empty-state" id="noInvestmentsMessage" style="display: none;">
                    <div class="empty-icon">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <h3>No Investment History</h3>
                    <p>Start your first investment to begin earning premium returns</p>
                    <button class="btn btn--primary" data-section="invest">
                        <i class="fas fa-rocket"></i>
                        Start Investing
                    </button>
                </div>

                <!-- Investment History -->
                <div class="investment-history" id="investmentHistory" style="display: none; margin-top: var(--spacing-3xl);">
                    <h3 style="text-align: center; margin-bottom: var(--spacing-xl); color: var(--white);">Your Investment History</h3>
                    <div id="investmentsList" class="stats-box">
                        <!-- Investments will be populated here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Invest Section -->
        <section class="invest-section section" id="invest" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h2 class="section__title">Investment Plans</h2>
                    <p class="section__subtitle">Select from our exclusive investment tiers and start earning premium returns</p>
                </div>

                <div class="alert alert-warning" id="investWalletAlert">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Please connect your wallet to start investing</span>
                </div>

                <div class="investment-plans" id="investmentPlans">
                    <!-- Plans will be populated by JavaScript -->
                </div>

                <div class="investment-form-container" id="investmentForm">
                    <div class="form-header">
                        <h2>Complete Your Investment</h2>
                        <button class="btn btn--outline btn-sm" id="backToPlans">
                            <i class="fas fa-arrow-left"></i>
                            Back to Plans
                        </button>
                    </div>

                    <div class="investment-form">
                        <div class="form-group">
                            <label for="selectedPlan">Selected Plan</label>
                            <div class="plan-summary" id="selectedPlanSummary">
                                <!-- Plan summary will be populated -->
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="investmentAmount">Investment Amount (USDT)</label>
                            <input type="number" id="investmentAmount" class="form-input" 
                                   placeholder="Enter amount in USDT" min="10" step="1">
                            <div class="amount-range" id="amountRange">
                                <!-- Range will be populated -->
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="referrerAddress">Referrer Address (Optional)</label>
                            <input type="text" id="referrerAddress" class="form-input" 
                                   placeholder="Enter referrer wallet address">
                            <small>If you were referred by someone, enter their wallet address here</small>
                        </div>

                        <div class="investment-summary">
                            <h3>Investment Summary</h3>
                            <div class="summary-item">
                                <span>Investment Amount:</span>
                                <span id="summaryAmount">0 USDT</span>
                            </div>
                            <div class="summary-item">
                                <span>Platform Fee (10%):</span>
                                <span id="summaryFee">0 USDT</span>
                            </div>
                            <div class="summary-item total">
                                <span>Total to Pay:</span>
                                <span id="summaryTotal">0 USDT</span>
                            </div>
                        </div>

                        <button class="btn btn--primary btn-lg" id="confirmInvestment" style="width: 100%;">
                            <i class="fas fa-check-circle"></i>
                            Confirm Investment
                        </button>
                    </div>
                </div>

                <div class="investment-success-popup" id="investmentSuccessPopup">
                    <div class="investment-success">
                        <div class="success-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h2>Investment Successful!</h2>
                        <p>You can now monitor your earnings in the dashboard</p>
                        <div class="success-actions">
                            <button class="btn btn--primary" data-section="dashboard">
                                <i class="fas fa-tachometer-alt"></i>
                                Go to Dashboard
                            </button>
                            <button class="btn btn--outline" id="newInvestment">
                                <i class="fas fa-plus"></i>
                                New Investment
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Referral Section -->
        <section class="referral-section section" id="referral" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h2 class="section__title">Referral Program</h2>
                    <p class="section__subtitle">Earn exclusive commissions from 15 levels of your referral network</p>
                </div>

                <div class="alert alert-warning" id="referralWalletAlert">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Please connect your wallet to access referral program</span>
                </div>

                <div class="referral-stats" id="referralStats" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalTeam">0</div>
                            <div class="stat-label">Total Team</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="referralBonusAmount">0 USDT</div>
                            <div class="stat-label">Referral Earnings</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="leadershipBonusAmount">0 USDT</div>
                            <div class="stat-label">Leadership Bonus</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-gift"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="referralLevel">0</div>
                            <div class="stat-label">Your Level</div>
                        </div>
                    </div>
                </div>

                <div class="referral-link-container" id="referralLinkSection" style="display: none;">
                    <h2>Your Referral Link</h2>
                    <p>Share this link with your network and earn commissions from their investments</p>
                    <div class="link-display">
                        <input type="text" id="referralLink" class="link-input" readonly>
                        <button class="btn btn--primary" id="copyLink">
                            <i class="fas fa-copy"></i>
                            Copy
                        </button>
                    </div>
                    <div class="social-share">
                        <button class="social-btn" id="shareTelegram">
                            <i class="fab fa-telegram"></i>
                        </button>
                        <button class="social-btn" id="shareTwitter">
                            <i class="fab fa-twitter"></i>
                        </button>
                        <button class="social-btn" id="shareWhatsapp">
                            <i class="fab fa-whatsapp"></i>
                        </button>
                    </div>
                </div>

                <div class="bonus-claim-section" id="bonusClaimSection" style="display: none;">
                    <div class="claim-card">
                        <div class="claim-info">
                            <h3>Available Referral Bonus</h3>
                            <p>You have referral earnings available for withdrawal</p>
                        </div>
                        <div class="bonus-amount" id="availableBonus">0 USDT</div>
                        <button class="btn btn--primary" id="claimReferralBonus">
                            <i class="fas fa-gift"></i>
                            Claim Bonus
                        </button>
                    </div>
                </div>

                <div class="bonus-claim-section" id="leadershipClaimSection" style="display: none;">
                    <div class="claim-card">
                        <div class="claim-info">
                            <h3>Available Leadership Bonus</h3>
                            <p>You have leadership earnings available for withdrawal</p>
                        </div>
                        <div class="bonus-amount" id="availableLeadership">0 USDT</div>
                        <button class="btn btn--primary" id="claimLeadershipBonus">
                            <i class="fas fa-crown"></i>
                            Claim Leadership
                        </button>
                    </div>
                </div>

                <div class="levels-grid" id="referralLevelsGrid">
                    <!-- Levels will be populated by JavaScript -->
                </div>

            </div>
        </section>

        <!-- Leadership Section -->
        <section class="leadership-section section" id="leadership" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h2 class="section__title">Leadership Program</h2>
                    <p class="section__subtitle">Unlock exclusive leadership bonuses by building a strong team and achieving investment milestones</p>
                </div>

                <div class="alert alert-warning" id="leadershipWalletAlert">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Please connect your wallet to view leadership program</span>
                </div>

                <div class="leadership-stats" id="leadershipStats" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="leadershipTeamCount">0</div>
                            <div class="stat-label">Active Team Members</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="leadershipBonusStats">0 USDT</div>
                            <div class="stat-label">Leadership Earnings</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="currentLeadershipLevel">0</div>
                            <div class="stat-label">Current Level</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="nextLevelProgress">0%</div>
                            <div class="stat-label">Next Level Progress</div>
                        </div>
                    </div>
                </div>

                <div class="leadership-grid" id="leadershipLevelsGrid">
                    <!-- Leadership levels will be populated by JavaScript -->
                </div>

                <div class="bonus-claim-section" id="leadershipBonusClaim" style="display: none;">
                    <div class="claim-card">
                        <div class="claim-info">
                            <h3>Available Leadership Bonus</h3>
                            <p>You have leadership earnings available for withdrawal. Build a stronger team to unlock higher bonuses!</p>
                        </div>
                        <div class="bonus-amount" id="availableLeadershipBonus">0 USDT</div>
                        <button class="btn btn--primary" id="claimLeadershipBonusMain">
                            <i class="fas fa-crown"></i>
                            Claim Leadership Bonus
                        </button>
                    </div>
                </div>

                <div class="leadership-info" style="margin-top: var(--spacing-3xl); text-align: center;">
                    <h3 style="color: var(--white); margin-bottom: var(--spacing-lg);">How Leadership Program Works</h3>
                    <div class="stats-box" style="text-align: left;">
                        <p style="color: var(--gray-300); line-height: 1.7; margin-bottom: var(--spacing-md);">
                            The Leadership Program rewards you for building and maintaining an active team. As your team grows and remains active, you unlock higher leadership levels with increased bonus rates.
                        </p>
                        <ul style="color: var(--gray-300); line-height: 1.7; padding-left: var(--spacing-lg);">
                            <li style="margin-bottom: var(--spacing-sm);">Each level requires a minimum number of active team members</li>
                            <li style="margin-bottom: var(--spacing-sm);">Leadership bonuses are calculated based on your team's ROI withdrawals</li>
                            <li style="margin-bottom: var(--spacing-sm);">Higher levels provide significantly increased bonus percentages</li>
                            <li>Your leadership level is automatically updated as your team grows</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- FAQ Section -->
        <section class="faq-section section" id="faq" style="display: none;">
            <div class="container">
                <div class="section__header">
                    <h2 class="section__title">Frequently Asked Questions</h2>
                    <p class="section__subtitle">Find answers to common questions about Nexagon</p>
                </div>

                <div class="faq-container">
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How does the investment process work?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>To start investing, connect your wallet, choose an investment plan, deposit USDT, and begin earning daily returns. Your earnings are calculated and available for withdrawal every 8 hours.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What are the minimum and maximum investment amounts?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>The minimum investment varies by plan: Gold Plan: 10-100 USDT, Platinum Plan: 50-100 USDT, Diamond Plan: 100+ USDT with no maximum limit.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How are daily returns calculated?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Daily returns are calculated based on your investment amount and the daily ROI rate of your chosen plan. Gold Plan: 1.6% daily, Platinum Plan: 0.9% daily, Diamond Plan: 0.5% daily.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How does the referral program work?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Our referral program has 15 levels with varying commission rates from 15% down to 1%. You earn commissions from your referrals' investments based on your total investment amount and level requirements.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How does the leadership program work?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>The leadership program rewards you for building an active team. With 3 levels requiring 200, 500, and 1000 active team members, you can earn additional bonuses of 3%, 7%, and 10% respectively from your team's ROI withdrawals.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Is there a withdrawal fee?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>No, there are no withdrawal fees for ROI or referral earnings. The contract only deducts a 10% owner fee from deposits to maintain platform operations.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How secure is Nexagon?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Nexagon uses audited smart contracts on the Binance Smart Chain. Our contracts have been verified and implement multiple security measures including reentrancy protection to protect user funds.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What happens if I refer someone but don't meet the requirements for higher levels?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>If you don't meet the minimum investment requirements for higher referral levels, the corresponding referral bonus will expire and be added to the expired contract balance, which is used for platform maintenance and development.</p>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Can I have multiple active investments at the same time?</h3>
                            <i class="fas fa-chevron-down faq-icon"></i>
                        </div>
                        <div class="faq-answer">
                            <p>Yes, you can have multiple active investments across different plans simultaneously. Each investment is tracked separately with its own ROI calculation and duration.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer__content">
                <div class="footer__brand">
                    <div class="footer__logo">
                        <img src="image/logo.png" alt="Nexagon Logo" class="logo">
                        <span>Nexagon</span>
                    </div>
                    <p class="footer__description">
                        Experience premium decentralized finance with Nexagon's advanced investment protocol. Earn stable daily returns through our optimized ROI system, backed by a 15-level referral program and secure smart contract technology.
                    </p>
                    <div class="footer__social">
                        <a href="#" class="social__link">
                            <i class="fab fa-telegram"></i>
                        </a>
                        <a href="#" class="social__link">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="https://bscscan.com/address/0xDe4F0C2F829E7fF547DA3958854d84E143985D5C" class="social__link">
                            <i class="fas fa-file-contract"></i>
                        </a>
                    </div>
                </div>
                <div class="footer__links">
                    <div class="footer__column">
                        <h4>Platform</h4>
                        <a class="footer-link" data-section="home">Home</a>
                        <a class="footer-link" data-section="statistics">Statistics</a>
                        <a class="footer-link" data-section="invest">Invest</a>
                        <a class="footer-link" data-section="referral">Referral</a>
                        <a class="footer-link" data-section="leadership">Leadership</a>
                        <a class="footer-link" data-section="dashboard">Dashboard</a>
                    </div>
                    <div class="footer__column">
                        <h4>Resources</h4>
                        <a href="https://bscscan.com/address/0xDe4F0C2F829E7fF547DA3958854d84E143985D5C">Contract</a>
                        <a class="footer-link" data-section="faq">FAQ</a>
                    </div>
                    <div class="footer__column">
                        <h4>Support</h4>
                        <a href="#">Contact Us</a>
                        <a href="#">Community</a>
                    </div>
                </div>
            </div>
            <div class="footer__bottom">
                <p>&copy; 2025 Nexagon. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // Contract Configuration - UPDATED TO MATCH YOUR CONTRACT
        const CONTRACT_ADDRESS = '0xDe4F0C2F829E7fF547DA3958854d84E143985D5C';
        const USDT_ADDRESS = '0x55d398326f99059fF775485246999027B3197955';
        const READ_ONLY_RPC = 'https://bsc-dataseed1.binance.org/';
        
        const USDT_ABI = [
            {"constant": false, "inputs": [{"name": "_spender", "type": "address"}, {"name": "_value", "type": "uint256"}], "name": "approve", "outputs": [{"name": "", "type": "bool"}], "type": "function"}, 
            {"constant": true, "inputs": [{"name": "_owner", "type": "address"}], "name": "balanceOf", "outputs": [{"name": "balance", "type": "uint256"}], "type": "function"}, 
            {"constant": true, "inputs": [{"name": "_owner", "type": "address"}, {"name": "_spender", "type": "address"}], "name": "allowance", "outputs": [{"name": "", "type": "uint256"}], "type": "function"}, 
            {"constant": true, "inputs": [], "name": "decimals", "outputs": [{"name": "", "type": "uint8"}], "type": "function"}
        ];
        
        // Updated ABI to match your contract
        const CONTRACT_ABI = [{"inputs":[{"internalType":"address","name":"_usdtAddress","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"leader","type":"address"},{"indexed":false,"internalType":"uint256","name":"level","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"LeadershipBonusAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"planId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"address","name":"referrer","type":"address"}],"name":"NewDeposit","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"referrer","type":"address"},{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"level","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ReferralBonusAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"ReferralExpiredWithdrawn","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"processedAmount","type":"uint256"}],"name":"SystemMetricsUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"WithdrawLeadership","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"WithdrawROI","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"}],"name":"WithdrawReferral","type":"event"},{"inputs":[],"name":"CLAIM_COOLDOWN","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"PERCENTS_DIVIDER","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ReferralExpired","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"TIME_STEP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"USDT","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"},{"internalType":"uint256","name":"_investmentIndex","type":"uint256"}],"name":"calculateRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getContractBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getLeadershipRates","outputs":[{"internalType":"uint256[3]","name":"","type":"uint256[3]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getLeadershipRequirements","outputs":[{"internalType":"uint256[3]","name":"","type":"uint256[3]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getNextWithdrawTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getPendingRewards","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_planId","type":"uint256"}],"name":"getPlanInfo","outputs":[{"internalType":"uint256","name":"minDeposit","type":"uint256"},{"internalType":"uint256","name":"maxDeposit","type":"uint256"},{"internalType":"uint256","name":"dailyROI","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"totalReturn","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getPlatformStats","outputs":[{"internalType":"uint256","name":"contractBalance","type":"uint256"},{"internalType":"uint256","name":"totalInvestors_","type":"uint256"},{"internalType":"uint256","name":"totalInvested_","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn_","type":"uint256"},{"internalType":"uint256","name":"totalReferralBonus_","type":"uint256"},{"internalType":"uint256","name":"totalLeadershipBonus_","type":"uint256"},{"internalType":"uint256","name":"referralExpiredBalance_","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getReferralRates","outputs":[{"internalType":"uint256[15]","name":"","type":"uint256[15]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getReferralRequirements","outputs":[{"internalType":"uint256[15]","name":"","type":"uint256[15]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getSystemMetrics","outputs":[{"internalType":"uint256","name":"lastOperation","type":"uint256"},{"internalType":"uint256","name":"totalProcessed","type":"uint256"},{"internalType":"uint256","name":"efficiencyFactor","type":"uint256"},{"internalType":"uint256","name":"reservePool","type":"uint256"},{"internalType":"uint256","name":"operationSequence","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getTeamMembersCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalInvest","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalPaidOut","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalUser","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getUserInfo","outputs":[{"internalType":"uint256","name":"totalInvested","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn","type":"uint256"},{"internalType":"uint256","name":"activeInvestments","type":"uint256"},{"internalType":"uint256","name":"referralBonus","type":"uint256"},{"internalType":"uint256","name":"referralBonusWithdrawn","type":"uint256"},{"internalType":"uint256","name":"leadershipBonus","type":"uint256"},{"internalType":"uint256","name":"leadershipBonusWithdrawn","type":"uint256"},{"internalType":"address","name":"referrer","type":"address"},{"internalType":"uint256[15]","name":"referralLevels","type":"uint256[15]"},{"internalType":"uint256[3]","name":"leadershipLevels","type":"uint256[3]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getUserInvestments","outputs":[{"internalType":"uint256[]","name":"planIds","type":"uint256[]"},{"internalType":"uint256[]","name":"amounts","type":"uint256[]"},{"internalType":"uint256[]","name":"startTimes","type":"uint256[]"},{"internalType":"uint256[]","name":"lastClaimTimes","type":"uint256[]"},{"internalType":"uint256[]","name":"totalClaimeds","type":"uint256[]"},{"internalType":"bool[]","name":"actives","type":"bool[]"},{"internalType":"uint256[]","name":"pendingRewards","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"hasActiveDeposit","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_planId","type":"uint256"},{"internalType":"uint256","name":"_amount","type":"uint256"},{"internalType":"address","name":"_referrer","type":"address"}],"name":"invest","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"leadershipRates","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"leadershipRequirements","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"plans","outputs":[{"internalType":"uint256","name":"minDeposit","type":"uint256"},{"internalType":"uint256","name":"maxDeposit","type":"uint256"},{"internalType":"uint256","name":"dailyROI","type":"uint256"},{"internalType":"uint256","name":"duration","type":"uint256"},{"internalType":"uint256","name":"totalReturn","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"referralExpiredBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"referralRates","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"referralRequirements","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalInvested","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalInvestors","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalLeadershipBonus","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalReferralBonus","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalWithdrawn","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"users","outputs":[{"internalType":"address","name":"referrer","type":"address"},{"internalType":"uint256","name":"totalInvested","type":"uint256"},{"internalType":"uint256","name":"totalWithdrawn","type":"uint256"},{"internalType":"uint256","name":"referralBonus","type":"uint256"},{"internalType":"uint256","name":"referralBonusWithdrawn","type":"uint256"},{"internalType":"uint256","name":"leadershipBonus","type":"uint256"},{"internalType":"uint256","name":"leadershipBonusWithdrawn","type":"uint256"},{"internalType":"bool","name":"registered","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"withdrawLeadership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawROI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawReferral","outputs":[],"stateMutability":"nonpayable","type":"function"}];

        // Global Variables
        let web3;
        let contract;
        let usdtContract;
        let userAccount;
        let selectedPlan = null;
        let referralAddress = null;

        // DOM Elements
        const preloader = document.querySelector('.preloader');
        const navMenu = document.getElementById('nav-menu');
        const navToggle = document.getElementById('nav-toggle');
        const connectWalletBtn = document.getElementById('connectWallet');
        const notification = document.getElementById('notification');
        const investmentSuccessPopup = document.getElementById('investmentSuccessPopup');

        const sections = {
            home: document.getElementById('home'),
            statistics: document.getElementById('statistics'),
            dashboard: document.getElementById('dashboard'),
            invest: document.getElementById('invest'),
            referral: document.getElementById('referral'),
            leadership: document.getElementById('leadership'),
            faq: document.getElementById('faq')
        };

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            generateInvestmentPlans();
            checkPreloader();
            checkURLForReferral();
            setupFAQ();
            generateReferralLevels(); // Initial generation for non-logged-in users
            generateLeadershipLevels(); // Initial generation for non-logged-in users
        });

        function setupFAQ() {
            const faqItems = document.querySelectorAll('.faq-item');
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                question.addEventListener('click', () => {
                    const isActive = item.classList.contains('active');
                    faqItems.forEach(otherItem => otherItem.classList.remove('active'));
                    if (!isActive) item.classList.add('active');
                });
            });
        }

        function checkURLForReferral() {
            const urlParams = new URLSearchParams(window.location.search);
            const refAddress = urlParams.get('ref');
            if (refAddress && Web3.utils.isAddress(refAddress)) {
                referralAddress = refAddress;
                document.getElementById('referrerAddress').value = refAddress;
                showNotification('Referral address detected from URL!', 'success');
            }
        }

        async function initializeApp() {
            try {
                web3 = new Web3(new Web3.providers.HttpProvider(READ_ONLY_RPC));
                contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
                await loadGlobalStats();
            } catch (error) {
                console.error('Error initializing read-only Web3:', error);
            }
            
            if (typeof window.ethereum !== 'undefined') {
                 try {
                    const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                    if (accounts.length > 0) {
                        await connectWallet();
                    }
                 } catch (err) {
                    console.error("Could not check for connected accounts:", err);
                 }
            }
        }

        async function loadGlobalStats() {
            if (!contract) return;
            try {
                const stats = await contract.methods.getPlatformStats().call();
                const formatUSDT = (weiValue) => parseFloat(web3.utils.fromWei(weiValue, 'ether')).toLocaleString('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
                
                document.getElementById('statTvl').textContent = `${formatUSDT(stats.contractBalance)} USDT`;
                document.getElementById('statTotalUsers').textContent = parseInt(stats.totalInvestors_).toLocaleString('en-US');
                document.getElementById('statTotalDeposit').textContent = `${formatUSDT(stats.totalInvested_)} USDT`;
                document.getElementById('statTotalPaidOut').textContent = `${formatUSDT(stats.totalWithdrawn_)} USDT`;

            } catch (error) {
                console.error('Error loading global stats:', error);
                ['statTvl', 'statTotalUsers', 'statTotalDeposit', 'statTotalPaidOut'].forEach(id => {
                    document.getElementById(id).textContent = 'Error';
                });
            }
        }

        async function connectWallet() {
            if (typeof window.ethereum === 'undefined') {
                return showNotification('Wallet not found! Please install MetaMask or Trust Wallet!', 'error');
            }
            try {
                web3 = new Web3(window.ethereum);
                contract = new web3.eth.Contract(CONTRACT_ABI, CONTRACT_ADDRESS);
                usdtContract = new web3.eth.Contract(USDT_ABI, USDT_ADDRESS);

                const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                
                if (chainId !== '0x38') {
                     try {
                        await window.ethereum.request({ 
                            method: 'wallet_switchEthereumChain', 
                            params: [{ chainId: '0x38' }] 
                        });
                    } catch (switchError) {
                        if (switchError.code === 4902) {
                            await window.ethereum.request({ 
                                method: 'wallet_addEthereumChain', 
                                params: [{ 
                                    chainId: '0x38', 
                                    chainName: 'Binance Smart Chain', 
                                    nativeCurrency: { name: 'BNB', symbol: 'BNB', decimals: 18 }, 
                                    rpcUrls: ['https://bsc-dataseed.binance.org/'], 
                                    blockExplorerUrls: ['https://bscscan.com/'] 
                                }] 
                            });
                        } else { throw switchError; }
                    }
                }
                
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                if (accounts.length > 0) {
                    userAccount = accounts[0];
                    updateWalletUI();
                    loadUserData();
                    showNotification('Wallet connected successfully!', 'success');
                }
            } catch (error) {
                console.error('Error connecting wallet:', error);
                showNotification(error.message.includes("rejected") ? 'Connection rejected by user' : 'Failed to connect wallet', 'error');
            }
        }

        function setupEventListeners() {
            navToggle.addEventListener('click', toggleNavMenu);
            document.addEventListener('click', (e) => {
                if (navMenu.classList.contains('active') && !navMenu.contains(e.target) && !navToggle.contains(e.target)) {
                    navMenu.classList.remove('active');
                }
            });
            document.querySelectorAll('.nav__link, .footer-link, button[data-section]').forEach(el => {
                el.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetElement = e.target.closest('[data-section]');
                    if (targetElement) {
                        const section = targetElement.getAttribute('data-section');
                        showSection(section);
                        navMenu.classList.remove('active');
                    }
                });
            });
            connectWalletBtn.addEventListener('click', connectWallet);
            document.getElementById('backToPlans').addEventListener('click', showPlans);
            document.getElementById('confirmInvestment').addEventListener('click', confirmInvestment);
            document.getElementById('newInvestment').addEventListener('click', () => {
                investmentSuccessPopup.classList.remove('active');
                showPlans();
            });
            document.getElementById('investmentAmount').addEventListener('input', updateInvestmentSummary);
            investmentSuccessPopup.addEventListener('click', (e) => {
                if (e.target === investmentSuccessPopup) {
                    investmentSuccessPopup.classList.remove('active');
                }
            });
            document.getElementById('withdrawROI').addEventListener('click', withdrawROI);
            document.getElementById('withdrawReferral').addEventListener('click', withdrawReferral);
            document.getElementById('withdrawLeadership').addEventListener('click', withdrawLeadership);
            document.getElementById('copyLink').addEventListener('click', copyReferralLink);
            document.getElementById('shareTelegram').addEventListener('click', () => shareOnSocial('telegram'));
            document.getElementById('shareTwitter').addEventListener('click', () => shareOnSocial('twitter'));
            document.getElementById('shareWhatsapp').addEventListener('click', () => shareOnSocial('whatsapp'));
            document.getElementById('claimReferralBonus').addEventListener('click', withdrawReferral);
            document.getElementById('claimLeadershipBonus').addEventListener('click', withdrawLeadership);
            document.getElementById('claimLeadershipBonusMain').addEventListener('click', withdrawLeadership);

            if (window.ethereum) {
                window.ethereum.on('accountsChanged', (accounts) => {
                    userAccount = accounts.length > 0 ? accounts[0] : null;
                    updateWalletUI();
                    if(userAccount) loadUserData();
                    else {
                        showWalletAlerts();
                        generateReferralLevels(); // Regenerate levels for non-logged-in view
                        generateLeadershipLevels(); // Regenerate levels for non-logged-in view
                    }
                });
                window.ethereum.on('chainChanged', () => window.location.reload());
            }
        }

        function toggleNavMenu() {
            navMenu.classList.toggle('active');
        }

        function showSection(sectionName) {
            Object.values(sections).forEach(section => {
                if (section) section.style.display = 'none';
            });
            document.querySelectorAll('.nav__link').forEach(link => link.classList.remove('active'));
            if (sections[sectionName]) {
                 sections[sectionName].style.display = 'flex';
                window.scrollTo(0, 0);
                const navLink = document.querySelector(`.nav__link[data-section="${sectionName}"]`);
                if (navLink) navLink.classList.add('active');
            }
        }

        function updateWalletUI() {
            if (userAccount) {
                connectWalletBtn.innerHTML = `<i class="fas fa-wallet"></i> ${userAccount.substring(0, 6)}...${userAccount.substring(userAccount.length - 4)}`;
                hideWalletAlerts();
            } else {
                connectWalletBtn.innerHTML = `<i class="fas fa-wallet"></i> Connect Wallet`;
                showWalletAlerts();
            }
        }

        function showWalletAlerts() {
            ['dashboardWalletAlert', 'investWalletAlert', 'referralWalletAlert', 'leadershipWalletAlert'].forEach(id => document.getElementById(id).style.display = 'flex');
            ['quickStats', 'actionButtons', 'noInvestmentsMessage', 'investmentHistory', 'referralStats', 'referralLinkSection', 'bonusClaimSection', 'leadershipClaimSection', 'leadershipStats', 'leadershipBonusClaim'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.style.display = 'none';
            });
        }

        function hideWalletAlerts() {
            ['dashboardWalletAlert', 'investWalletAlert', 'referralWalletAlert', 'leadershipWalletAlert'].forEach(id => document.getElementById(id).style.display = 'none');
             ['quickStats', 'referralStats', 'leadershipStats'].forEach(id => {
                 const el = document.getElementById(id);
                if (el) el.style.display = 'grid';
            });
            document.getElementById('actionButtons').style.display = 'flex';
             document.getElementById('referralLinkSection').style.display = 'block';
        }

        async function loadUserData() {
            if (!contract || !userAccount) return;
            try {
                const userInfo = await contract.methods.getUserInfo(userAccount).call();
                const pendingRewards = await contract.methods.getPendingRewards(userAccount).call();
                const teamCount = await contract.methods.getTeamMembersCount(userAccount).call();

                const formatUSDT = (weiValue) => parseFloat(web3.utils.fromWei(weiValue, 'ether')).toFixed(2);
                
                document.getElementById('totalInvested').textContent = `${formatUSDT(userInfo.totalInvested)} USDT`;
                document.getElementById('pendingRewards').textContent = `${formatUSDT(pendingRewards)} USDT`;
                document.getElementById('totalWithdrawn').textContent = `${formatUSDT(userInfo.totalWithdrawn)} USDT`;
                document.getElementById('referralBonus').textContent = `${formatUSDT(userInfo.referralBonus)} USDT`;
                document.getElementById('leadershipBonus').textContent = `${formatUSDT(userInfo.leadershipBonus)} USDT`;
                document.getElementById('referralBonusAmount').textContent = `${formatUSDT(userInfo.referralBonus)} USDT`;
                document.getElementById('leadershipBonusAmount').textContent = `${formatUSDT(userInfo.leadershipBonus)} USDT`;
                document.getElementById('leadershipTeamCount').textContent = teamCount;
                document.getElementById('leadershipBonusStats').textContent = `${formatUSDT(userInfo.leadershipBonus)} USDT`;
                document.getElementById('availableBonus').textContent = `${formatUSDT(userInfo.referralBonus)} USDT`;
                document.getElementById('availableLeadership').textContent = `${formatUSDT(userInfo.leadershipBonus)} USDT`;
                document.getElementById('availableLeadershipBonus').textContent = `${formatUSDT(userInfo.leadershipBonus)} USDT`;
                
                // Calculate referral level based on total invested
                let userLevel = 0;
                const referralRequirements = await contract.methods.getReferralRequirements().call();
                for (let i = 0; i < referralRequirements.length; i++) {
                    if (new BigNumber(userInfo.totalInvested).isGreaterThanOrEqualTo(new BigNumber(referralRequirements[i]))) {
                        userLevel = i + 1;
                    } else {
                        break;
                    }
                }
                document.getElementById('referralLevel').textContent = userLevel;
                
                // Calculate leadership level based on team count
                let leadershipLevel = 0;
                const leadershipRequirements = await contract.methods.getLeadershipRequirements().call();
                for (let i = 0; i < leadershipRequirements.length; i++) {
                    if (parseInt(teamCount) >= parseInt(leadershipRequirements[i])) {
                        leadershipLevel = i + 1;
                    } else {
                        break;
                    }
                }
                document.getElementById('currentLeadershipLevel').textContent = leadershipLevel;
                
                // Calculate next level progress
                let nextLevelProgress = 0;
                if (leadershipLevel < 3) {
                    const currentRequirement = leadershipLevel > 0 ? parseInt(leadershipRequirements[leadershipLevel-1]) : 0;
                    const nextRequirement = parseInt(leadershipRequirements[leadershipLevel]);
                    nextLevelProgress = Math.min(100, Math.round((parseInt(teamCount) - currentRequirement) / (nextRequirement - currentRequirement) * 100));
                } else {
                    nextLevelProgress = 100;
                }
                document.getElementById('nextLevelProgress').textContent = `${nextLevelProgress}%`;
                
                // Show/hide bonus claim sections
                if (parseInt(userInfo.referralBonus) > 0) {
                    document.getElementById('bonusClaimSection').style.display = 'block';
                } else {
                    document.getElementById('bonusClaimSection').style.display = 'none';
                }

                if (parseInt(userInfo.leadershipBonus) > 0) {
                    document.getElementById('leadershipClaimSection').style.display = 'block';
                    document.getElementById('leadershipBonusClaim').style.display = 'block';
                } else {
                    document.getElementById('leadershipClaimSection').style.display = 'none';
                    document.getElementById('leadershipBonusClaim').style.display = 'none';
                }

                const investments = await contract.methods.getUserInvestments(userAccount).call();
                document.getElementById('noInvestmentsMessage').style.display = investments.planIds.length === 0 ? 'flex' : 'none';
                document.getElementById('investmentHistory').style.display = investments.planIds.length > 0 ? 'block' : 'none';

                // Display investment history
                displayInvestmentHistory(investments);

                generateReferralLink();
                // Ensure referral link section is visible after connecting wallet and loading data
                document.getElementById('referralLinkSection').style.display = 'block';
                
                // Regenerate referral levels with user data
                generateReferralLevels(userInfo.totalInvested);
                // Regenerate leadership levels with user data
                generateLeadershipLevels(teamCount);

            } catch (error) {
                console.error('Error loading user data:', error);
            }
        }

        function displayInvestmentHistory(investments) {
            const investmentsList = document.getElementById('investmentsList');
            if (!investmentsList) return;

            if (investments.planIds.length === 0) {
                investmentsList.innerHTML = '<p style="text-align: center; color: var(--gray-400);">No investments found</p>';
                return;
            }

            let html = '';
            for (let i = 0; i < investments.planIds.length; i++) {
                const planId = investments.planIds[i];
                const amount = web3.utils.fromWei(investments.amounts[i], 'ether');
                const startTime = new Date(investments.startTimes[i] * 1000).toLocaleDateString();
                const lastClaimTime = investments.lastClaimTimes[i] > 0 ? 
                    new Date(investments.lastClaimTimes[i] * 1000).toLocaleDateString() : 'Never';
                const totalClaimed = web3.utils.fromWei(investments.totalClaimeds[i], 'ether');
                const isActive = investments.actives[i];
                const pendingRewards = web3.utils.fromWei(investments.pendingRewards[i], 'ether');

                const planNames = ['Gold Plan', 'Platinum Plan', 'Diamond Plan'];
                
                html += `
                    <div class="stat-entry">
                        <span class="stat-entry__address">${planNames[planId]}</span>
                        <span class="stat-entry__time">Started: ${startTime}</span>
                        <span class="stat-entry__amount">${amount} USDT</span>
                        <span class="stat-entry__time">Last Claim: ${lastClaimTime}</span>
                        <span class="stat-entry__amount">Claimed: ${totalClaimed} USDT</span>
                        <span class="stat-entry__time">Pending: ${pendingRewards} USDT</span>
                        <span class="stat-entry__amount" style="color: ${isActive ? '#10B981' : '#EF4444'}">
                            ${isActive ? 'Active' : 'Completed'}
                        </span>
                    </div>
                `;
            }
            investmentsList.innerHTML = html;
        }

        function generateReferralLink() {
            const linkInput = document.getElementById('referralLink');
            if (linkInput && userAccount) {
                linkInput.value = `${window.location.origin}${window.location.pathname}?ref=${userAccount}`;
            }
        }

        function generateInvestmentPlans() {
            const plansContainer = document.getElementById('investmentPlans');
            if (!plansContainer) return;
            const plans = [
                {id: 0, name: 'Gold Plan', roi: '1.6% Daily', range: '10 - 100 USDT', duration: '7 Days', total: '112% Total ROI', features: ['1.6% Daily ROI', '7 Days Duration', '112% Total Returns', '15-Level Referral'], featured: false},
                {id: 1, name: 'Platinum Plan', roi: '0.9% Daily', range: '50 - 100 USDT', duration: '14 Days', total: '126% Total ROI', features: ['0.9% Daily ROI', '14 Days Duration', '126% Total Returns', '15-Level Referral'], featured: true},
                {id: 2, name: 'Diamond Plan', roi: '0.5% Daily', range: '100+ USDT', duration: '30 Days', total: '150% Total ROI', features: ['0.5% Daily ROI', '30 Days Duration', '150% Total Returns', '15-Level Referral'], featured: false}
            ];
            plansContainer.innerHTML = plans.map(plan => `
                <div class="plan-card ${plan.featured ? 'featured' : ''}" data-plan-id="${plan.id}">
                    ${plan.featured ? '<div class="plan-badge">Popular</div>' : ''}
                    <div class="plan-name">${plan.name}</div>
                    <div class="plan-roi">${plan.roi}</div>
                    <div class="plan-range">${plan.range}</div>
                    <div class="plan-duration">${plan.duration}</div>
                    <div class="plan-total">${plan.total}</div>
                    <ul class="plan-features">${plan.features.map(f => `<li><i class="fas fa-check"></i> ${f}</li>`).join('')}</ul>
                    <button class="btn btn--primary" style="margin-top: auto;"><i class="fas fa-arrow-right"></i> Select Plan</button>
                </div>
            `).join('');
            document.querySelectorAll('.plan-card').forEach(card => {
                card.addEventListener('click', (e) => selectPlan(parseInt(e.currentTarget.getAttribute('data-plan-id'))));
            });
        }

        function selectPlan(planId) {
            if (!userAccount) return showNotification('Please connect your wallet first!', 'error');
            const plansData = [
                { id: 0, name: 'Gold Plan', roi: '1.6% Daily', min: 10, max: 100 },
                { id: 1, name: 'Platinum Plan', roi: '0.9% Daily', min: 50, max: 100 },
                { id: 2, name: 'Diamond Plan', roi: '0.5% Daily', min: 100, max: Infinity }
            ];
            selectedPlan = plansData.find(p => p.id === planId);
            if (selectedPlan) showInvestmentForm();
        }

        function showInvestmentForm() {
            document.getElementById('investmentPlans').style.display = 'none';
            document.getElementById('investmentForm').classList.add('active');
            document.getElementById('selectedPlanSummary').innerHTML = `<div class="plan-name">${selectedPlan.name}</div><div class="plan-roi">${selectedPlan.roi}</div>`;
            const maxText = selectedPlan.max === Infinity ? 'Unlimited' : selectedPlan.max;
            document.getElementById('amountRange').textContent = `Minimum: ${selectedPlan.min} USDT, Maximum: ${maxText} USDT`;
            const amountInput = document.getElementById('investmentAmount');
            amountInput.min = selectedPlan.min;
            amountInput.max = selectedPlan.max === Infinity ? '' : selectedPlan.max;
            amountInput.value = selectedPlan.min;
            updateInvestmentSummary();
        }

        function showPlans() {
            document.getElementById('investmentPlans').style.display = 'grid';
            document.getElementById('investmentForm').classList.remove('active');
            selectedPlan = null;
        }

        function updateInvestmentSummary() {
            const amount = parseFloat(document.getElementById('investmentAmount').value) || 0;
            const fee = amount * 0.10; // 10% platform fee
            const total = amount + fee;
            
            document.getElementById('summaryAmount').textContent = `${amount.toFixed(2)} USDT`;
            document.getElementById('summaryFee').textContent = `${fee.toFixed(2)} USDT`;
            document.getElementById('summaryTotal').textContent = `${total.toFixed(2)} USDT`;
        }

        async function confirmInvestment() {
            if (!contract || !userAccount) return showNotification('Please connect wallet', 'error');
            if (!selectedPlan) return showNotification('Please select a plan', 'error');
            const amount = parseFloat(document.getElementById('investmentAmount').value) || 0;
            if (amount < selectedPlan.min || (selectedPlan.max !== Infinity && amount > selectedPlan.max)) {
                return showNotification(`Amount must be between ${selectedPlan.min} and ${selectedPlan.max === Infinity ? '' : selectedPlan.max} USDT`, 'error');
            }
            let refAddr = document.getElementById('referrerAddress').value.trim() || referralAddress || '0x0000000000000000000000000000000000000000';
            if (!web3.utils.isAddress(refAddr)) return showNotification('Invalid referrer address', 'error');
            
            const confirmBtn = document.getElementById('confirmInvestment');
            confirmBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            confirmBtn.disabled = true;

            try {
                const amountWei = web3.utils.toWei(amount.toString(), 'ether');
                const balance = await usdtContract.methods.balanceOf(userAccount).call();
                if (new BigNumber(balance).isLessThan(new BigNumber(amountWei))) {
                    throw new Error(`Insufficient USDT. You have ${web3.utils.fromWei(balance, 'ether')} USDT`);
                }
                const allowance = await usdtContract.methods.allowance(userAccount, CONTRACT_ADDRESS).call();
                if (new BigNumber(allowance).isLessThan(new BigNumber(amountWei))) {
                    showNotification('Approving USDT...', 'info');
                    await usdtContract.methods.approve(CONTRACT_ADDRESS, '115792089237316195423570985008687907853269984665640564039457584007913129639935').send({ from: userAccount });
                    showNotification('Approval successful!', 'success');
                }
                showNotification('Depositing...', 'info');
                await contract.methods.invest(selectedPlan.id, amountWei, refAddr).send({ from: userAccount });
                showNotification('Investment successful!', 'success');
                investmentSuccessPopup.classList.add('active');
                await loadUserData();
                await loadGlobalStats();
            } catch (error) {
                console.error('Investment error:', error);
                showNotification(error.message.includes("rejected") ? 'Transaction rejected' : 'Investment failed', 'error');
            } finally {
                confirmBtn.innerHTML = '<i class="fas fa-check-circle"></i> Confirm Investment';
                confirmBtn.disabled = false;
            }
        }

        async function withdrawROI() {
            if (!contract || !userAccount) return showNotification('Please connect wallet', 'error');
            const btn = document.getElementById('withdrawROI');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Withdrawing...';
            btn.disabled = true;
            try {
                await contract.methods.withdrawROI().send({ from: userAccount });
                showNotification('ROI withdrawal successful!', 'success');
                await loadUserData();
                await loadGlobalStats();
            } catch (error) {
                console.error('Withdrawal error:', error);
                showNotification(error.message.includes("rejected") ? 'Transaction rejected' : 'Withdrawal failed', 'error');
            } finally {
                btn.innerHTML = '<i class="fas fa-download"></i> Withdraw ROI';
                btn.disabled = false;
            }
        }

        async function withdrawReferral() {
            if (!contract || !userAccount) return showNotification('Please connect wallet', 'error');
            const btn = document.getElementById('withdrawReferral');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Withdrawing...';
            btn.disabled = true;
            try {
                await contract.methods.withdrawReferral().send({ from: userAccount });
                showNotification('Referral bonus withdrawal successful!', 'success');
                await loadUserData();
                await loadGlobalStats();
            } catch (error) {
                console.error('Referral withdrawal error:', error);
                showNotification(error.message.includes("rejected") ? 'Transaction rejected' : 'Withdrawal failed', 'error');
            } finally {
                btn.innerHTML = '<i class="fas fa-gift"></i> Withdraw Referral';
                btn.disabled = false;
            }
        }

        async function withdrawLeadership() {
            if (!contract || !userAccount) return showNotification('Please connect wallet', 'error');
            const btn = document.getElementById('withdrawLeadership');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Withdrawing...';
            btn.disabled = true;
            try {
                await contract.methods.withdrawLeadership().send({ from: userAccount });
                showNotification('Leadership bonus withdrawal successful!', 'success');
                await loadUserData();
                await loadGlobalStats();
            } catch (error) {
                console.error('Leadership withdrawal error:', error);
                showNotification(error.message.includes("rejected") ? 'Transaction rejected' : 'Withdrawal failed', 'error');
            } finally {
                btn.innerHTML = '<i class="fas fa-crown"></i> Withdraw Leadership';
                btn.disabled = false;
            }
        }

        function copyReferralLink() {
            const linkInput = document.getElementById('referralLink');
            navigator.clipboard.writeText(linkInput.value).then(() => showNotification('Referral link copied!', 'success'));
        }

        function shareOnSocial(platform) {
            const link = document.getElementById('referralLink').value;
            const text = encodeURIComponent('Join Nexagon - Advanced DeFi Investment Platform with 15-level referral program and secure smart contract technology!');
            const urls = {
                telegram: `https://t.me/share/url?url=${link}&text=${text}`,
                twitter: `https://twitter.com/intent/tweet?url=${link}&text=${text}`,
                whatsapp: `https://wa.me/?text=${text}%20${link}`
            };
            if (urls[platform]) window.open(urls[platform], '_blank');
        }

        async function generateReferralLevels(userTotalInvested = '0') {
            const levelsContainer = document.getElementById('referralLevelsGrid');
            if (!levelsContainer) return;

            const userInvestedBN = new BigNumber(userTotalInvested);
            
            const levels = [
                { level: 1, commission: '15%', requirement: '10', requirementWei: web3.utils.toWei('10', 'ether') },
                { level: 2, commission: '10%', requirement: '50', requirementWei: web3.utils.toWei('50', 'ether') },
                { level: 3, commission: '5%', requirement: '100', requirementWei: web3.utils.toWei('100', 'ether') },
                { level: 4, commission: '5%', requirement: '150', requirementWei: web3.utils.toWei('150', 'ether') },
                { level: 5, commission: '3%', requirement: '200', requirementWei: web3.utils.toWei('200', 'ether') },
                { level: 6, commission: '3%', requirement: '250', requirementWei: web3.utils.toWei('250', 'ether') },
                { level: 7, commission: '3%', requirement: '300', requirementWei: web3.utils.toWei('300', 'ether') },
                { level: 8, commission: '2%', requirement: '350', requirementWei: web3.utils.toWei('350', 'ether') },
                { level: 9, commission: '2%', requirement: '400', requirementWei: web3.utils.toWei('400', 'ether') },
                { level: 10, commission: '2%', requirement: '450', requirementWei: web3.utils.toWei('450', 'ether') },
                { level: 11, commission: '1%', requirement: '500', requirementWei: web3.utils.toWei('500', 'ether') },
                { level: 12, commission: '1%', requirement: '550', requirementWei: web3.utils.toWei('550', 'ether') },
                { level: 13, commission: '1%', requirement: '600', requirementWei: web3.utils.toWei('600', 'ether') },
                { level: 14, commission: '1%', requirement: '650', requirementWei: web3.utils.toWei('650', 'ether') },
                { level: 15, commission: '1%', requirement: '700', requirementWei: web3.utils.toWei('700', 'ether') }
            ];
            
            levelsContainer.innerHTML = levels.map(level => {
                const isLocked = userInvestedBN.isLessThan(new BigNumber(level.requirementWei));
                const lockClass = isLocked ? 'locked' : 'unlocked';
                
                return `
                    <div class="level-card ${lockClass}">
                        ${isLocked ? '<div class="lock-icon"><i class="fas fa-lock"></i></div>' : ''}
                        <div class="level-header">
                            <div class="level-number">${level.level}</div>
                            <div class="level-commission">${level.commission} Commission</div>
                        </div>
                        <div class="level-requirements">
                            <div class="requirement">
                                <i class="fas fa-wallet"></i>
                                <span>Minimum Invest: ${level.requirement} USDT</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        async function generateLeadershipLevels(teamCount = 0) {
            const levelsContainer = document.getElementById('leadershipLevelsGrid');
            if (!levelsContainer) return;

            const teamCountNum = parseInt(teamCount);
            
            const levels = [
                { level: 1, title: 'Team Leader', bonus: '3%', requirement: '200', description: 'Build a team of 200 active members' },
                { level: 2, title: 'Senior Leader', bonus: '7%', requirement: '500', description: 'Expand your team to 500 active members' },
                { level: 3, title: 'Executive Leader', bonus: '10%', requirement: '1000', description: 'Achieve 1000 active team members' }
            ];
            
            levelsContainer.innerHTML = levels.map(level => {
                const isLocked = teamCountNum < parseInt(level.requirement);
                const lockClass = isLocked ? 'locked' : 'unlocked';
                
                return `
                    <div class="leadership-card ${lockClass}">
                        ${isLocked ? '<div class="lock-icon"><i class="fas fa-lock"></i></div>' : ''}
                        <div class="leadership-header">
                            <div class="leadership-level">${level.level}</div>
                            <div class="leadership-title">${level.title}</div>
                            <div class="leadership-bonus">${level.bonus} Bonus</div>
                        </div>
                        <div class="leadership-requirements">
                            <div class="leadership-requirement">
                                <i class="fas fa-users"></i>
                                <span>${level.requirement} Active Team Members</span>
                            </div>
                            <div class="leadership-requirement">
                                <i class="fas fa-info-circle"></i>
                                <span>${level.description}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showNotification(message, type = 'info') {
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            setTimeout(() => notification.classList.remove('show'), 5000);
        }

        function checkPreloader() {
            window.addEventListener('load', () => setTimeout(() => preloader.classList.add('fade-out'), 500));
        }
    </script>
</body>
</html>
